!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}("undefined"!=typeof window?window:this,function(a){var b=function(b){var c=[];return c.jquery=b,c["graph.axis"]=function(a){var b=function(){};return b.prototype={defaults:{lineAt0:!1,display:!0,flipped:!1,axisDataSpacing:{min:.1,max:.1},unitModification:!1,primaryGrid:!0,secondaryGrid:!0,shiftToZero:!1,tickPosition:1,nbTicksPrimary:3,nbTicksSecondary:10,ticklabelratio:1,exponentialFactor:0,exponentialLabelFactor:0,wheelBaseline:"min",logScale:!1,allowedPxSerie:100,forcedMin:!1,forcedMax:!1},init:function(c,d,e){this.unitModificationTimeTicks=[[1,[1,2,5,10,20,30]],[60,[1,2,5,10,20,30]],[3600,[1,2,6,12]],[86400,[1,2,3,4,5,10,20,40]]];var f=this;this.graph=c,this.options=a.extend(!0,{},b.prototype.defaults,e,d),this.group=document.createElementNS(this.graph.ns,"g"),this.hasChanged=!0,this.groupGrids=document.createElementNS(this.graph.ns,"g"),this.graph.axisGroup.insertBefore(this.groupGrids,this.graph.axisGroup.firstChild),this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent"),this.group.appendChild(this.rectEvent),this.setEvents(),this.graph.axisGroup.appendChild(this.group),this.line=document.createElementNS(this.graph.ns,"line"),this.line.setAttribute("stroke","black"),this.line.setAttribute("shape-rendering","crispEdges"),this.line.setAttribute("stroke-linecap","square"),this.groupTicks=document.createElementNS(this.graph.ns,"g"),this.groupTickLabels=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupTicks),this.group.appendChild(this.groupTickLabels),this.group.appendChild(this.line),this.labelValue,this.label=document.createElementNS(this.graph.ns,"text"),this.labelTspan=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.labelTspan),this.expTspan=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.expTspan),this.expTspan.setAttribute("dx",10),this.expTspanExp=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.expTspanExp),this.expTspanExp.setAttribute("dy",-5),this.expTspanExp.setAttribute("font-size","0.8em"),this.label.setAttribute("text-anchor","middle"),this.groupGrids.setAttribute("clip-path","url(#_clipplot"+this.graph._creation+")"),this.graph.applyStyleText(this.label),this.group.appendChild(this.label),this.groupSeries=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupSeries),this.ticks=[],this.series=[],this.totalDelta=0,this.currentAction=!1,this.group.addEventListener("mousemove",function(a){a.preventDefault();var b=f.graph.getXY(a);f.handleMouseMoveLocal(b.x,b.y,a);for(var c=0,d=f.series.length;d>c;c++)f.series[c].handleMouseMove(!1,!0),"labelDragging"==f.currentAction&&f.series[c].handleLabelMove(b.x,b.y),"labelDraggingMain"==f.currentAction&&f.series[c].handleLabelMainMove(b.x,b.y)}),this.group.addEventListener("mouseup",function(a){a.preventDefault(),f.handleMouseUp()}),this.group.addEventListener("mouseout",function(a){a.preventDefault();var b=f.graph.getXY(a);f.handleMouseOutLocal(b.x,b.y,a)}),this.labels=[],this.group.addEventListener("click",function(a){a.preventDefault();var b=f.graph.getXY(a);f.addLabel(f.getVal(b.x-f.graph.getPaddingLeft()))}),this.axisRand=Math.random(),this.clip=document.createElementNS(this.graph.ns,"clipPath"),this.clip.setAttribute("id","_clip"+this.axisRand),this.graph.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.graph.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse")},setEvents:function(){var a=this;this.rectEvent.addEventListener("mousedown",function(b){if(b.stopPropagation(),b.preventDefault(),3!=b.which&&!b.ctrlKey){var c=a.graph.getXY(b);switch(a.graph.currentAction="zooming",a.graph._zoomingMode=a instanceof GraphXAxis?"x":"y",a.graph._zoomingXStart=c.x,a.graph._zoomingYStart=c.y,a.graph._zoomingXStartRel=c.x-a.graph.getPaddingLeft(),a.graph._zoomingYStartRel=c.y-a.graph.getPaddingTop(),a.this._zoomingSquare.setAttribute("width",0),a.this._zoomingSquare.setAttribute("height",0),a.graph._zoomingMode){case"x":a.this._zoomingSquare.setAttribute("y",a.graph.getPaddingTop()+a.shift-a.totalDimension),a.this._zoomingSquare.setAttribute("height",a.totalDimension);break;case"y":a.this._zoomingSquare.setAttribute("x",a.graph.getPaddingLeft()+a.shift-a.totalDimension),a.this._zoomingSquare.setAttribute("width",a.totalDimension)}a.this._zoomingSquare.setAttribute("display","block")}})},addLabel:function(a){for(var b=0,c=this.series.length;c>b;b++)this.series[b].currentAction===!1&&this.series[b].addLabelObj({x:a})},setDisplay:function(a){return this.options.display=!!a,this},setLineAt0:function(a){this.options.lineAt0=!!a},setAxisDataSpacing:function(a,b){this.options.axisDataSpacing.min=a,this.options.axisDataSpacing.max=b||a},setAxisDataSpacingMin:function(a){this.options.axisDataSpacing.min=a},setAxisDataSpacingMax:function(a){this.options.axisDataSpacing.max=a},setMinPx:function(a){this.minPx=a},getMinPx:function(){return this.options.flipped?this.maxPx:this.minPx},setMaxPx:function(a){this.maxPx=a},getMaxPx:function(){return this.options.flipped?this.minPx:this.maxPx},getMathMaxPx:function(){return this.maxPx},getMinValue:function(){return this.options.forcedMin||(0===this.options.forcedMin?0:this.dataMin)},getMaxValue:function(){return this.options.forcedMax||(0===this.options.forcedMax?0:this.dataMax)},setMinValueData:function(a){this.dataMin=a},setMaxValueData:function(a){this.dataMax=a},forceMin:function(a){this.options.forcedMin=a},forceMax:function(a){this.options.forcedMax=a},getNbTicksPrimary:function(){return this.options.nbTicksPrimary},getNbTicksSecondary:function(){return this.options.nbTicksSecondary},handleMouseMove:function(a){this.mouseVal=this.getVal(a)},handleMouseWheel:function(a){a=Math.min(.2,Math.max(-.2,a));var b;b="min"==this.options.wheelBaseline?this.getActualMin():"max"==this.options.wheelBaseline?this.getActualMax():this.options.wheelBaseline,this._doZoomVal((this.getActualMax()-b)*(1+a)+b,(this.getActualMin()-b)*(1+a)+b),this.graph.redraw(!0)},handleMouseUp:function(a){if("labelDragging"==this.currentAction||"labelDraggingMain"==this.currentAction){for(var b=0,c=this.series.length;c>b;b++)this.series[b].handleLabelUp();this.currentAction=!1}else this.graph.isZooming()&&this._handleZoom(a)},_doZoomVal:function(a,b,c){return this._doZoom(this.getPx(a),this.getPx(b),a,b,c)},_doZoom:function(a,b,c,d,e){var c=c||this.getVal(a),d=d||this.getVal(b);this.setCurrentMin(Math.min(c,d)),this.setCurrentMax(Math.max(c,d)),this._hasChanged=!0,this.options.onZoom&&!e&&this.options.onZoom(this.currentAxisMin,this.currentAxisMax)},getSerieShift:function(){return this._serieShift},getSerieScale:function(){return this._serieScale},getMouseVal:function(){return this.mouseVal},isFlipped:function(){return this.options.flipped},getUnitPerTick:function(a,b,c,d){var e=a/q;b=b?Math.min(b,a/10):a/10;var f=c/b;if("time"==this.options.unitModification){var d=this.getModifiedValue(this.getMaxValue());umin=3600>d?0:86400>d?1:2;for(var g=!1,h=0,i=this.unitModificationTimeTicks.length;i>h;h++){for(var j=0,k=this.unitModificationTimeTicks[h][1].length;k>j;j++)if(f<this.unitModificationTimeTicks[h][0]*this.unitModificationTimeTicks[h][1][j]){g=!0;break}if(g)break}p=h!==this.unitModificationTimeTicks.length?this.unitModificationTimeTicks[h][0]*this.unitModificationTimeTicks[h][1][j]:1}else{var l=Math.floor(Math.log(f)/Math.log(10)),m=f*Math.pow(10,-l);this.decimals=-l;for(var n=[1,2,5,10],o=!1,h=n.length-1;h>=0;h--)(!o||Math.abs(n[h]-m)<Math.abs(o-m))&&(o=n[h]);var p=o*Math.pow(10,l)}var q=c/p,e=a/b;return[p,q,e]},setMinMaxToFitSeries:function(){var a=this.getMaxValue()-this.getMinValue();this.currentAxisMin=this.getMinValue()-this.options.axisDataSpacing.min*a,this.currentAxisMax=this.getMaxValue()+this.options.axisDataSpacing.max*a,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,this.currentAxisMin),this.currentAxisMax=Math.max(1e-50,this.currentAxisMax))},_getActualInterval:function(){return this.getActualMax()-this.getActualMin()},getActualMin:function(){return this.currentAxisMin==this.currentAxisMax?this.currentAxisMin-1:this.currentAxisMin},getActualMax:function(){return this.currentAxisMax==this.currentAxisMin?this.currentAxisMax+1:this.currentAxisMax},setCurrentMin:function(a){this.currentAxisMin=a,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,a))},setCurrentMax:function(a){this.currentAxisMax=a,this.options.logScale&&(this.currentAxisMax=Math.max(1e-50,a))},flip:function(a){return this.options.flipped=a,this},_draw:function(){var a;switch(this.options.tickPosition){case 3:this.tickPx1=-2,this.tickPx2=0;break;case 2:this.tickPx1=-1,this.tickPx2=1;break;case 1:this.tickPx1=0,this.tickPx2=2}for(;this.groupTicks.firstChild;)this.groupTicks.removeChild(this.groupTicks.firstChild);for(;this.groupTickLabels.firstChild;)this.groupTickLabels.removeChild(this.groupTickLabels.firstChild);for(;this.groupGrids.firstChild;)this.groupGrids.removeChild(this.groupGrids.firstChild);(void 0==this.currentAxisMin||void 0==!this.currentAxisMax)&&this.setMinMaxToFitSeries();var b=this.maxPx-this.minPx,c=this._getActualInterval();if(!this.options.display)return this.line.setAttribute("display","none"),0;if(this.line.setAttribute("display","block"),this.options.hideTicks)var d=0;else if(this.options.logScale)var d=this.drawLogTicks();else{this.options.scientificTicks&&(this.scientificExp=Math.floor(Math.log(Math.max(Math.abs(this.getActualMax()),Math.abs(this.getActualMin())))/Math.log(10)));var e=this.getNbTicksPrimary(),f=this.getUnitPerTick(b,e,c,this.getActualMax()),g=this.secondaryTicks();if(g)var g=g;var d=this.drawTicks(f,g)}var h;return(h=this.getLabel())&&(this.labelTspan.textContent=h,this.getExponentialLabelFactor()?(this.expTspan.nodeValue="x10",this.expTspanExp.nodeValue=this.getExponentialLabelFactor(),a=!0):this.options.scientificTicks?(this.expTspan.textContent="x10",this.expTspanExp.textContent=this.scientificExp,a=!0):a=!1,this.expTspan.setAttribute("display",a?"block":"none"),this.expTspanExp.setAttribute("display",a?"block":"none")),this.drawSpecifics(),this.options.lineAt0&&this.getActualMin()<0&&this.getActualMax()>0&&this._draw0Line(this.getPx(0)),d+(h?20:0)},setTickLabelRatio:function(a){this.options.ticklabelratio=a},draw:function(){this._widthLabels=0;var a=this._draw();return this._widthLabels+=a,a},drawTicks:function(a,b){var c,d,e,f=a[0],g=this.getActualMin(),h=this.getActualMax(),i=0;for(b&&(c=f/b),d=this.options.shiftToZero?this.dataMin-Math.ceil((this.dataMin-g)/f)*f:Math.floor(g/f)*f,this.incrTick=a[0],this.resetTicks();h>d&&(i++,!(i>200));){if(b){e=d+c;for(var j=0;d+f>e&&(j++,!(j>100));)g>e||e>h?e+=c:(this.drawTick(e,!1,Math.abs(e-d-f/2)<1e-4?3:2),e+=c)}g>d||d>h?d+=a[0]:(this.drawTick(d,!0,4),d+=a[0])}return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},resetTicks:function(){},secondaryTicks:function(){return this.options.nbTicksSecondary},drawLogTicks:function(){var a=this.getActualMin(),b=this.getActualMax(),c=Math.min(a,b),b=Math.max(a,b),d={fontSize:"1.0em",exponential:!0,overwrite:!1};0>c&&(c=0);for(var e,f=0==c?0:Math.floor(Math.log(c)/Math.log(10)),c=1;(e=c*Math.pow(10,f))<b;)1==c&&e>a&&this.drawTick(e,!0,5,d),10==c?(c=1,f++):(1!=c&&e>a&&this.drawTick(e,!0,2,{overwrite:c,fontSize:"0.6em"}),c++);return 5},getPx:function(a){return this.getPos(a)},getPos:function(a){if(this.options.logScale){if(0>a)return;var a=(Math.log(a)-Math.log(this.getActualMin()))/(Math.log(this.getActualMax())-Math.log(this.getActualMin()))*(this.getMaxPx()-this.getMinPx())+this.getMinPx();return a}return(a-this.getActualMin())/this._getActualInterval()*(this.getMaxPx()-this.getMinPx())+this.getMinPx()},getRelPx:function(a){return a/this._getActualInterval()*(this.getMaxPx()-this.getMinPx())},getRelVal:function(a){return a/(this.getMaxPx()-this.getMinPx())*this._getActualInterval()},getVal:function(a){return(a-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*this._getActualInterval()+this.getActualMin()},valueToText:function(a){if(this.options.scientificTicks)return a/=Math.pow(10,this.scientificExp),a.toFixed(1);if(a=a*Math.pow(10,this.getExponentialFactor())*Math.pow(10,this.getExponentialLabelFactor()),this.options.shiftToZero&&(a-=this.dataMin),this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.unitModification)return a=this.modifyUnit(a,this.options.unitModification);var b=this.decimals-this.getExponentialFactor()-this.getExponentialLabelFactor();return a.toFixed(b>0?b:0)},getModifiedValue:function(a){return this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.shiftToZero&&(a-=this.getMinValue()*(this.options.ticklabelratio||1)),a},modifyUnit:function(a,b){switch(b){case"time":var c=this.getModifiedValue(this.getMaxValue()),d=[[60,"min"],[3600,"h"],[86400,"d"]];3600>c?umin=0:86400>c?umin=1:2592e3>c&&(umin=2)}var e,f=this.incrTick,g="";for(a/=d[umin][0],e=Math.floor(a),g=e+d[umin][1],umin--;f<1*d[umin+1][0]&&umin>-1;)first=!1,a=(a-e)*d[umin+1][0]/d[umin][0],e=Math.round(a),g+=" "+e+d[umin][1],umin--;return g},getExponentialFactor:function(){return this.options.exponentialFactor},setExponentialFactor:function(a){this.options.exponentialFactor=a},setExponentialLabelFactor:function(a){this.options.exponentialLabelFactor=a},getExponentialLabelFactor:function(){return this.options.exponentialLabelFactor},setLabel:function(a){return this.options.labelValue=a,this},getLabel:function(){return this.options.labelValue},setShift:function(a,b){this.shift=a,this.totalDimension=b,this._setShift()},getShift:function(){return this.shift},setTickPosition:function(a){switch(a){case 3:case"outside":a=3;break;case 2:case"centered":a=2;break;default:case 1:case"inside":a=1}return this.options.tickPosition=a,this},togglePrimaryGrid:function(a){return this.options.primaryGrid=a,this},toggleSecondaryGrid:function(a){return this.options.secondaryGrid=a,this},doGridLine:function(a,b,c,d,e){var f=document.createElementNS(this.graph.ns,"line");f.setAttribute("shape-rendering","crispEdges"),f.setAttribute("y1",d),f.setAttribute("y2",e),f.setAttribute("x1",b),f.setAttribute("x2",c),f.setAttribute("stroke",a?this.getColorPrimaryGrid():this.getColorSecondaryGrid()),this.groupGrids.appendChild(f)},getColorPrimaryGrid:function(){return"#c0c0c0"},getColorSecondaryGrid:function(){return"#f0f0f0"},setTickContent:function(a,b,c){if(c||(c={}),c.overwrite||!c.exponential)a.textContent=c.overwrite||this.valueToText(b);else{var d=Math.round(Math.log(b)/Math.log(10)),e=Math.floor(b*Math.pow(10,-d));a.textContent=1!=e?e+"x10":"10";var f=document.createElementNS(this.graph.ns,"tspan");f.textContent=d,f.setAttribute("font-size","0.7em"),f.setAttribute("dy",-3),a.appendChild(f)}c.fontSize&&a.setAttribute("font-size",c.fontSize)},removeSerie:function(a){this.series.splice(this.series.indexOf(a),1)},killSeries:function(a){for(var b=0;b<this.series.length;b++)this.series[b].kill(a);this.series=[]},removeSeries:function(){this.killSeries()},handleMouseOutLocal:function(){for(var a=0,b=this.series.length;b>a;a++)this.series[a].hideTrackingMarker()}},b}(c.jquery),c["graph.axis.x"]=function(a,b){var c=function(a,b,c){this.init(a,c),this.top="top"==b};return a.extend(c.prototype,b.prototype,{getAxisPosition:function(){if(!this.options.display)return 0;var a=(1==this.options.tickPosition?15:25)+2*this.graph.options.fontSize;return this.options.allowedPxSerie&&this.series.length>0&&(a+=this.options.allowedPxSerie),a},getAxisWidthHeight:function(){},_setShift:function(){this.group.setAttribute("transform","translate(0 "+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},getMaxSizeTick:function(){return(this.top?-1:1)*(1==this.options.tickPosition?10:10)},drawTick:function(a,b,c,d){var e=(this.groupTicks,document.createElementNS(this.graph.ns,"line")),f=this.getPos(a);if(void 0!=f){if(e.setAttribute("shape-rendering","crispEdges"),e.setAttribute("x1",f),e.setAttribute("x2",f),e.setAttribute("y1",(this.top?1:-1)*this.tickPx1*c),e.setAttribute("y2",(this.top?1:-1)*this.tickPx2*c),b&&this.options.primaryGrid?this.doGridLine(!0,f,f,0,this.graph.getDrawingHeight()):!b&&this.options.secondaryGrid&&this.doGridLine(!1,f,f,0,this.graph.getDrawingHeight()),e.setAttribute("stroke","black"),this.groupTicks.appendChild(e),b){var g=(this.groupTickLabels,document.createElementNS(this.graph.ns,"text"));g.setAttribute("x",f),g.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?8:20)+(this.top?10:0))),g.setAttribute("text-anchor","middle"),g.style.dominantBaseline="hanging",this.setTickContent(g,a,d),this.graph.applyStyleText(g),this.groupTickLabels.appendChild(g)}this.ticks.push(e)}},drawSpecifics:function(){this.label.setAttribute("text-anchor","middle"),this.label.setAttribute("x",Math.abs(this.getMaxPx()-this.getMinPx())/2+this.getMinPx()),this.label.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?10:15)+this.graph.options.fontSize)),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0),this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging"},drawSeries:function(){if(this.shift){this.rectEvent.setAttribute("y",this.top?-this.shift:0),this.rectEvent.setAttribute("height",this.totalDimension),this.rectEvent.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.rectEvent.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx())),this.clipRect.setAttribute("y",this.top?-this.shift:0),this.clipRect.setAttribute("height",this.totalDimension),this.clipRect.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.clipRect.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx()));for(var a=0,b=this.series.length;b>a;a++)this.series[a].draw()}},_draw0Line:function(a){this._0line=document.createElementNS(this.graph.ns,"line"),this._0line.setAttribute("x1",a),this._0line.setAttribute("x2",a),this._0line.setAttribute("y1",0),this._0line.setAttribute("y2",this.getMaxPx()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},addSerie:function(a,b){var c=new GraphSerieAxisX(a,b);return c.setAxis(this),c.init(this.graph,a,b),c.autoAxis(),c.setXAxis(this),this.series.push(c),this.groupSeries.appendChild(c.groupMain),this.groupSeries.setAttribute("clip-path","url(#_clip"+this.axisRand+")"),c},handleMouseMoveLocal:function(a){a-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(a)},isXY:function(){return"x"}}),c}(c.jquery,c["graph.axis"]),c["graph.axis.y"]=function(a){var c=function(a,b,c){this.init(a,c,{flipped:!0}),this.leftright=b,this.left="left"==b};return b.extend(c.prototype,a.prototype,{getAxisPosition:function(){var a=0;return this.options.display?(this.options.allowedPxSerie&&this.series.length>0&&(a=this.options.allowedPxSerie),a):0},getAxisWidthHeight:function(){return 15},resetTicks:function(){this.longestTick=[!1,0]},getMaxSizeTick:function(){return(this.longestTick[0]?this.longestTick[0].getComputedTextLength():0)+10},drawTick:function(a,b,c,d){var e,f=(this.groupTicks,this.getPos(a));if(void 0!=f){var g=document.createElementNS(this.graph.ns,"line");if(g.setAttribute("shape-rendering","crispEdges"),g.setAttribute("y1",f),g.setAttribute("y2",f),g.setAttribute("x1",(this.left?1:-1)*this.tickPx1*c),g.setAttribute("x2",(this.left?1:-1)*this.tickPx2*c),g.setAttribute("stroke","black"),b&&this.options.primaryGrid?this.doGridLine(!0,0,this.graph.getDrawingWidth(),f,f):!b&&this.options.secondaryGrid&&this.doGridLine(!1,0,this.graph.getDrawingWidth(),f,f),this.groupTicks.appendChild(g),b){{this.groupTickLabels}e=document.createElementNS(this.graph.ns,"text"),e.setAttribute("y",f),e.setAttribute("x",this.left?-10:10),this.left?e.setAttribute("text-anchor","end"):e.setAttribute("text-anchor","start"),e.style.dominantBaseline="central",this.graph.applyStyleText(e),this.setTickContent(e,a,d),this.groupTickLabels.appendChild(e),String(e).length>=this.longestTick[1]&&(this.longestTick[0]=e,this.longestTick[1]=String(e.textContent).length)}this.ticks.push(g)}},drawSpecifics:function(){this.label.setAttribute("transform","translate("+(this.left?1:-1)*(-this.widthHeightTick-8)+", "+(Math.abs(this.getMaxPx()-this.getMinPx())/2+Math.min(this.getMinPx(),this.getMaxPx()))+") rotate(-90)"),this.line.setAttribute("y1",this.getMinPx()),this.line.setAttribute("y2",this.getMaxPx()),this.line.setAttribute("x1",0),this.line.setAttribute("x2",0)},drawSeries:function(){if(this.shift){this.rectEvent.setAttribute("x",this.left?-this.shift:0),this.rectEvent.setAttribute("width",this.totalDimension),this.rectEvent.setAttribute("y",Math.min(this.getMinPx(),this.getMaxPx())),this.rectEvent.setAttribute("height",Math.abs(this.getMinPx()-this.getMaxPx())),this.clipRect.setAttribute("x",-this.shift),this.clipRect.setAttribute("width",this.totalDimension),this.clipRect.setAttribute("y",Math.min(this.getMinPx(),this.getMaxPx())),this.clipRect.setAttribute("height",Math.abs(this.getMinPx()-this.getMaxPx()));for(var a=0,b=this.series.length;b>a;a++)this.series[a].draw()}},_setShift:function(){var a=this.isLeft()?this.getShift():this.graph.getWidth()-this.graph.getPaddingRight()-this.graph.getPaddingLeft()-this.getShift();this.group.setAttribute("transform","translate("+a+" 0)")},isLeft:function(){return this.left},isRight:function(){return!this.left},flip:function(a){return this.options.flipped=!a,this},_draw0Line:function(a){this._0line=document.createElementNS(this.graph.ns,"line"),this._0line.setAttribute("y1",a),this._0line.setAttribute("y2",a),this._0line.setAttribute("x1",0),this._0line.setAttribute("x2",this.graph.getDrawingWidth()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},addSerie:function(a,b){var c=new GraphSerieAxisY(a,b);return c.init(this.graph,a,b),c.setAxis(this),c.autoAxis(),c.setYAxis(this),this.series.push(c),this.groupSeries.appendChild(c.groupMain),this.groupSeries.setAttribute("clip-path","url(#_clip"+this.axisRand+")"),c},handleMouseMoveLocal:function(a,b){b-=this.graph.getPaddingTop(),this.mouseVal=this.getVal(b)},scaleToFitAxis:function(a,b,c){for(var d=0,e=0,f=this.graph.series.length;f>e;e++)this.graph.series[e].getXAxis()==a&&(d=Math.max(d,this.graph.series[e].getMax(b,c)));this._doZoomVal(0,d)},isXY:function(){return"y"}}),c}(c["graph.axis"]),c["graph.legend"]=function(){var a={frame:!1,backgroundColor:"transparent",frameWidth:0,frameColor:"transparent",paddingTop:10,paddingLeft:10,paddingBottom:10,paddingRight:10,movable:!1},c=function(c,d){this.options=b.extend({},a,d),this.graph=c,this.svg=document.createElementNS(this.graph.ns,"g"),this.rect=document.createElementNS(this.graph.ns,"rect"),this.rectBottom=document.createElementNS(this.graph.ns,"rect"),this.rect.setAttribute("x",0),this.rect.setAttribute("y",0),this.rectBottom.setAttribute("x",0),this.rectBottom.setAttribute("y",0),this.pos={x:void 0,y:void 0,transformX:0,transformY:0},this.setEvents(),this.applyStyle()};return c.prototype={setPosition:function(a,b,c){if(a){var d=this.graph.getPosition(a);"right"==b&&(d.x-=this.width),"bottom"==c&&(d.y-=this.height),this.pos.transformX=d.x,this.pos.transformY=d.y,this._setPosition()}},update:function(){var a=this;for(this.applyStyle();this.svg.hasChildNodes();)this.svg.removeChild(this.svg.lastChild);this.svg.appendChild(this.rectBottom);for(var b=this.graph.getSeries(),c=0,d=b.length;d>c;c++)!function(d){var e,f,g;e=document.createElementNS(a.graph.ns,"g"),e.setAttribute("transform","translate(0, "+(16*c+10+a.options.paddingTop)+")"),a.svg.appendChild(e);var f=b[d].getSymbolForLegend(),h=b[d].getMarkerForLegend(),g=b[d].getTextForLegend();e.appendChild(f),h&&e.appendChild(h),e.appendChild(g),e.addEventListener("click",function(){var c=b[d];c.isSelected()?(c.hide(),a.graph.unselectSerie(c)):c.isShown()?a.graph.selectSerie(c):c.show()})}(c);var e=this.svg.getBBox();this.width=e.width+this.options.paddingRight+this.options.paddingLeft,this.height=e.height+this.options.paddingBottom+this.options.paddingTop,this.rect.setAttribute("width",this.width),this.rect.setAttribute("height",this.height),this.rect.setAttribute("fill","none"),this.rect.setAttribute("pointer-events","fill"),this.rect.setAttribute("display","none"),this.options.movable&&(this.rectBottom.style.cursor="move"),this.rectBottom.setAttribute("width",this.width),this.rectBottom.setAttribute("height",this.height),this.rectBottom.setAttribute("x",e.x-this.options.paddingLeft),this.rectBottom.setAttribute("y",e.y-this.options.paddingTop),this.svg.appendChild(this.rect)},getDom:function(){return this.svg},setEvents:function(){var a=this,b=this.pos,c=function(c){a.options.movable&&(b.x=c.clientX,b.y=c.clientY,c.stopPropagation(),c.preventDefault(),a.mousedown=!0,a.graph.shapeMoving(a),a.rect.setAttribute("display","block"))},d=function(b){a.handleMouseMove(b)};this.rectBottom.addEventListener("mousedown",c),this.rectBottom.addEventListener("mousemove",d),this.rect.addEventListener("mousemove",d)},handleMouseUp:function(a){a.stopPropagation(),a.preventDefault(),this.mousedown=!1,this.rect.setAttribute("display","none"),this.graph.shapeStopMoving()},handleMouseMove:function(a){if(this.mousedown){var b=this.pos,c=a.clientX-b.x,d=a.clientY-b.y;b.transformX+=c,b.transformY+=d,b.x=a.clientX,b.y=a.clientY,a.stopPropagation(),a.preventDefault(),this._setPosition()}},_setPosition:function(){var a=this.pos;this.svg.setAttribute("transform","translate("+a.transformX+", "+a.transformY+")")},applyStyle:function(){this.options.frame&&(this.rectBottom.setAttribute("stroke",this.options.frameColor),this.rectBottom.setAttribute("stroke-width",this.options.frameWidth+"px")),this.rectBottom.setAttribute("fill",this.options.backgroundColor)}},c}(),c.dynamicdepencies=function(){return function(){this.caching={},this.folderMap={},this.load=function(a,b,d){var e=this;return this.caching[a]||(this.caching[a]={}),Array.isArray(b)?void b.map(function(b){e.load(a,b,d)}):(this.folderMap[a]&&(b=this.folderMap[a]+b),this.caching[a][b]?d(this.caching[a][b],b)||this.caching[a][b]:"undefined"!=typeof c&&c[b]?d(this.caching[a][b]=c[b],b)||this.caching[a][b]:void("undefined"!=typeof require?require([b],function(c){d(e.caching[a][b]=c,b)}):console.warn("Could not load file "+b+" of type "+a)))},this.configure=function(a){this.folderMap=a||{}}}}(),c["graph.core"]=function(b,c,d,e,f){function g(a,b,c,d,e){return a.dynamicLoader.load("serie","graph.serie."+d,function(d){var f=new d;return f.init(a,b,c),a.plotGroup.appendChild(f.groupMain),e(f),f})}function h(a){return a&&a.indexOf&&a.indexOf("px")>-1?parseInt(a.replace("px","")):!1}var i={title:"",paddingTop:30,paddingBottom:5,paddingLeft:20,paddingRight:20,close:{left:!0,right:!0,top:!0,bottom:!0},lineToZero:!1,fontSize:12,fontFamily:"Myriad Pro, Helvetica, Arial",addLabelOnClick:!1,onVerticalTracking:!1,onHorizontalTracking:!1,rangeLimitX:10,rangeLimitY:0,plugins:[],pluginAction:{},wheel:{},dblclick:{},dynamicDependencies:{plugin:"plugins/",serie:"series/",shapes:"shapes/"},series:["line"]},j=function(a,e,g,h){var j=this;if(this._creation=Date.now()+Math.random(),"string"==typeof a&&(a=document.getElementById(a)),!a||!a.appendChild)throw"The DOM has not been defined";"function"==typeof g&&(h=g,g=!1),"function"==typeof e&&(h=e,e={}),this.options=b.extend({},i,e),this.axis={left:[],top:[],bottom:[],right:[]},this.shapes=[],this.shapesLocked=!1,this.ns="http://www.w3.org/2000/svg",this.nsxlink="http://www.w3.org/1999/xlink",this.series=[],this._dom=a,this.doDom(),this.setSize(b(a).width(),b(a).height()),this._resize(),this.registerEvents(),this.dynamicLoader=new f,this.dynamicLoader.configure(this.options.dynamicDependencies),this.trackingLines={id:0,current:!1,dasharray:[!1,"5, 5","5, 1","1, 5"],currentDasharray:[],vertical:[],horizontal:[]},this.shapeHandlers={mouseDown:[],mouseUp:[],mouseMove:[],mouseOver:[],mouseOut:[]},this.pluginsReady=b.Deferred(),this.seriesReady=b.Deferred(),this.currentAction=!1,h&&b.when(this.pluginsReady,this.seriesReady).then(function(){h(j)});var k;if(g)for(var l in g)for(var m=0,n=g[l].length;n>m;m++){switch(l){case"top":k="setTopAxis";var o=new c(this,"top",g[l][m]);break;case"bottom":k="setBottomAxis";var o=new c(this,"bottom",g[l][m]);break;case"left":k="setLeftAxis";var o=new d(this,"left",g[l][m]);break;case"right":k="setRightAxis";var o=new d(this,"right",g[l][m])}this[k](o,m)}this._pluginsInit(),this._seriesInit()};return j.prototype={setAttributeTo:function(a,b,c){var d;if(c)for(d in b)a.setAttributeNS(c,d,b[d]);else for(d in b)a.setAttribute(d,b[d])},doDom:function(){this.dom=document.createElementNS(this.ns,"svg"),this.dom.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.setAttributeTo(this.dom,{xmlns:this.ns,"font-family":this.options.fontFamily,"font-size":this.options.fontSize}),this._dom.appendChild(this.dom),this._dom.setAttribute("tabindex",1),this._dom.style.outline="none",this.defs=document.createElementNS(this.ns,"defs"),this.dom.appendChild(this.defs),this.rectEvent=document.createElementNS(this.ns,"rect"),this.setAttributeTo(this.rectEvent,{"pointer-events":"fill",fill:"transparent"}),this.dom.appendChild(this.rectEvent),this.domTitle=document.createElementNS(this.ns,"text"),this.setTitle(this.options.title),this.setAttributeTo(this.domTitle,{"text-anchor":"middle",y:20}),this.dom.appendChild(this.domTitle),this.graphingZone=document.createElementNS(this.ns,"g"),this.setAttributeTo(this.graphingZone,{transform:"translate("+this.options.paddingLeft+", "+this.options.paddingTop+")"}),this.dom.appendChild(this.graphingZone),this.axisGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.axisGroup),this.shapeZone=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.shapeZone),this.plotGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.plotGroup),this._makeClosingLines(),this.clip=document.createElementNS(this.ns,"clipPath"),this.clip.setAttribute("id","_clipplot"+this._creation),this.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse"),this.markerArrow=document.createElementNS(this.ns,"marker"),this.markerArrow.setAttribute("viewBox","0 0 10 10"),this.markerArrow.setAttribute("id","arrow"+this._creation),this.markerArrow.setAttribute("refX","0"),this.markerArrow.setAttribute("refY","5"),this.markerArrow.setAttribute("markerUnits","strokeWidth"),this.markerArrow.setAttribute("markerWidth","4"),this.markerArrow.setAttribute("markerHeight","3"),this.markerArrow.setAttribute("orient","auto");var a=document.createElementNS(this.ns,"path");a.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),a.setAttribute("fill","context-stroke"),this.markerArrow.appendChild(a),this.defs.appendChild(this.markerArrow),this.vertLineArrow=document.createElementNS(this.ns,"marker"),this.vertLineArrow.setAttribute("viewBox","0 0 10 10"),this.vertLineArrow.setAttribute("id","verticalline"+this._creation),this.vertLineArrow.setAttribute("refX","0"),this.vertLineArrow.setAttribute("refY","5"),this.vertLineArrow.setAttribute("markerUnits","strokeWidth"),this.vertLineArrow.setAttribute("markerWidth","20"),this.vertLineArrow.setAttribute("markerHeight","10"),this.vertLineArrow.setAttribute("orient","auto"),this.vertLineArrow.setAttribute("stroke-width","1px");var b=document.createElementNS(this.ns,"path");b.setAttribute("d","M 0 -10 L 0 10"),b.setAttribute("stroke","black"),this.vertLineArrow.appendChild(b),this.defs.appendChild(this.vertLineArrow),this.plotGroup.setAttribute("clip-path","url(#_clipplot"+this._creation+")"),this.bypassHandleMouse=!1
},setOption:function(a,b){this.options[a]=b},kill:function(){this._dom.removeChild(this.dom)},getXY:function(c){var d=c.clientX,e=c.clientY,f=b(this._dom).offset();return d-=f.left-a.scrollX,e-=f.top-a.scrollY,{x:d,y:e}},registerEvents:function(){var b=this;this._dom.addEventListener("keydown",function(a){a.preventDefault(),a.stopPropagation(),8==a.keyCode&&b.selectedShape&&b.selectedShape.kill()}),this.dom.addEventListener("mousemove",function(a){a.preventDefault();var c=b.getXY(a);b.handleMouseMove(c.x,c.y,a)}),this.dom.addEventListener("mousedown",function(a){if(b.focus(),a.preventDefault(),3!=a.which&&!a.ctrlKey){var c=b.getXY(a);b.handleMouseDown(c.x,c.y,a)}}),this.dom.addEventListener("mouseup",function(a){a.preventDefault();var c=b.getXY(a);b.handleMouseUp(c.x,c.y,a)}),this.dom.addEventListener("dblclick",function(c){c.preventDefault(),b.clickTimeout&&a.clearTimeout(b.clickTimeout);var d=b.getXY(c);b.cancelClick=!0,b.handleDblClick(d.x,d.y,c)}),this.dom.addEventListener("click",function(c){if(3!=c.which&&!c.ctrlKey){c.preventDefault();var d=b.getXY(c);b.clickTimeout&&a.clearTimeout(b.clickTimeout),b.clickTimeout=a.setTimeout(function(){b.handleClick(d.x,d.y,c)},200)}}),this.rectEvent.addEventListener("mousewheel",function(a){a.preventDefault(),a.stopPropagation();var c=a.wheelDeltaY||a.wheelDelta||-a.deltaY;return b.handleMouseWheel(c,a),!1}),this.rectEvent.addEventListener("wheel",function(a){a.stopPropagation(),a.preventDefault();var c=a.wheelDeltaY||a.wheelDelta||-a.deltaY;return b.handleMouseWheel(c,a),!1})},focus:function(){this._dom.focus()},allowPlugin:function(a,b){if(this.forcedPlugin==b)return!0;var c=this.options.pluginAction[b]||{},d=a.shiftKey,e=a.ctrlKey;return d!==c.shift?!1:e!==c.ctrl?!1:!0},handleMouseDown:function(a,c,d){var e,f=(b(d.target),d.shiftKey),g=d.ctrlKey,h=this.options.pluginAction;if(this.unselectShape(),this.forcedPlugin)return this.activePlugin=this.forcedPlugin,void this._pluginExecute(this.activePlugin,"onMouseDown",[this,a,c,d]);for(e in h){if(!h[e]._forced){if(f!==h[e].shift)continue;if(g!==h[e].ctrl)continue}this.activePlugin=e,this._pluginExecute(e,"onMouseDown",[this,a,c,d]);break}},handleMouseMove:function(a,b,c){return this.bypassHandleMouse?void this.bypassHandleMouse.handleMouseMove(c):void this._pluginExecute(this.activePlugin,"onMouseMove",[this,a,b,c])},forcePlugin:function(a){this.forcedPlugin=a},unforcePlugin:function(){this.forcedPlugin=!1},handleMouseUp:function(a,b,c){return this.bypassHandleMouse?(this.bypassHandleMouse.handleMouseUp(c),void(this.activePlugin=!1)):(this._pluginExecute(this.activePlugin,"onMouseUp",[this,a,b,c]),void(this.activePlugin=!1))},handleMouseWheel:function(a,b){if(b.preventDefault(),b.stopPropagation(),this.options.wheel.type){switch(this.options.wheel.type){case"plugin":var c;(c=this._plugins[this.options.wheel.plugin])&&c.onMouseWheel(a,b);break;case"toSeries":for(var d=0,e=this.series.length;e>d;d++)this.series[d].onMouseWheel(a,b)}this.redraw(),this.drawSeries(!0)}},handleClick:function(a){if(this.options.addLabelOnClick&&this.currentAction===!1)for(var b=0,c=this.series.length;c>b;b++)this.series[b].addLabelX(this.series[b].getXAxis().getVal(a-this.getPaddingLeft()))},shapeMoving:function(a){this.bypassHandleMouse=a},shapeStopMoving:function(){this.bypassHandleMouse=!1},handleDblClick:function(a,b,c){var d=this.options.dblclick;if(d&&d.type)switch(d.type){case"plugin":var e;(e=this._plugins[d.plugin])&&e.onDblClick(this,a,b,d.options,c)}},resetAxis:function(){for(;this.axisGroup.firstChild;)this.axisGroup.removeChild(this.axisGroup.firstChild);this.axis.left=[],this.axis.right=[],this.axis.bottom=[],this.axis.top=[]},resetSeries:function(){for(var a=0;a<this.series.length;a++)this.series[a].kill(!0);this.series=[]},applyToAxis:{string:function(a,b,c){for(var d=0;d<this.axis[a].length;d++)this.axis[a][d][b].apply(this.axis[a][d],c)},"function":function(a,b){for(var c=0;c<this.axis[a].length;c++)b.call(this,this.axis[a][c],a)}},applyToAxes:function(a,b,c,d){var e,f=[],g=0;for((c||void 0==c)&&(f.push("top"),f.push("bottom")),(d||void 0==d)&&(f.push("left"),f.push("right")),e=f.length;e>g;g++)this.applyToAxis[typeof a].call(this,f[g],a,b)},setWidth:function(a,b){this.width=a,b||this._resize()},getWidth:function(){return this.width},setHeight:function(a,b){this.height=a,b||this._resize()},getHeight:function(){return this.height},resize:function(a,b){this.setSize(a,b),this._resize()},setSize:function(a,b){this.setWidth(a,!0),this.setHeight(b,!0),this.getDrawingHeight(),this.getDrawingWidth()},getDom:function(){return this.dom},applyStyleText:function(){},getXAxis:function(a,b){return this.axis.top.length>0&&0==this.axis.bottom.length?this.getTopAxis(a,b):this.getBottomAxis(a,b)},getYAxis:function(a,b){return this.axis.right.length>0&&0==this.axis.left.length?this.getRightAxis(a,b):this.getLeftAxis(a,b)},_getAxis:function(a,b,c,d){return a=a||0,"object"==typeof a&&(b=a,a=0),this.axis[d][a]=this.axis[d][a]||new c(this,d,b)},getTopAxis:function(a,b){return this._getAxis(a,b,c,"top")},getBottomAxis:function(a,b){return this._getAxis(a,b,c,"bottom")},getLeftAxis:function(a,b){return this._getAxis(a,b,d,"left")},getRightAxis:function(a,b){return this._getAxis(a,b,d,"right")},setXAxis:function(a,b){this.setBottomAxis(a,b)},setYAxis:function(a,b){this.setLeftAxis(a,b)},setLeftAxis:function(a,b){b=b||0,this.axis.left[b]=a},setRightAxis:function(a,b){b=b||0,this.axis.right[b]=a},setTopAxis:function(a,b){b=b||0,this.axis.top[b]=a},setBottomAxis:function(a,b){b=b||0,this.axis.bottom[b]=a},getPaddingTop:function(){return this.options.paddingTop},getPaddingLeft:function(){return this.options.paddingLeft},getPaddingBottom:function(){return this.options.paddingTop},getPaddingRight:function(){return this.options.paddingRight},setTitle:function(a){this.options.title=a,this.domTitle.textContent=a},displayTitle:function(){this.domTitle.setAttribute("display","inline")},hideTitle:function(){this.domTitle.setAttribute("display","none")},drawSerie:function(a){a.draw(this.getDrawingGroup())},getDrawingHeight:function(a){if(a&&this.innerHeight)return this.innerHeight;var b=this.height-this.options.paddingTop-this.options.paddingBottom;return this.innerHeight=b},getDrawingWidth:function(a){if(a&&this.innerWidth)return this.innerWidth;var b=this.width-this.options.paddingLeft-this.options.paddingRight;return this.innerWidth=b},getBoundaryAxisFromSeries:function(a,b,c){var d,e,f,g,h,i,j,k="x"==b,l="min"==c,m=k?["getMinX","getMaxX"]:["getMinY","getMaxY"],n=m[l?0:1];for(d=l?Number.MAX_VALUE:Number.MIN_VALUE,g=this.getSeriesFromAxis(a,!0),i=0,j=g.length;j>i;i++)f=g[i],h=f[n](),d=Math[c](d,h),d==h&&e&&(e.isMinOrMax(!1,b,c),e=f,f.isMinOrMax(!0,b,c));return d},getSeriesFromAxis:function(a,b){for(var c=[],d=this.series.length-1;d>=0;d--)(this.series[d].getXAxis()==a||this.series[d].getYAxis()==a)&&c.push(this.series[d]);if(b)for(d=0;d<a.series.length;d++)c.push(a.series[d]);return c},_resize:function(){this.width&&this.height&&(this.sizeSet=!0,this.dom.setAttribute("width",this.width),this.dom.setAttribute("height",this.height),this.domTitle.setAttribute("x",this.width/2),this.refreshDrawingZone())},canRedraw:function(){return this.width&&this.height},redraw:function(a,b){return this.canRedraw()?(this.sizeSet?this.refreshDrawingZone(a,b):this._resize(),!0):void 0},updateAxes:function(){var a,b,c,d,e,f=["bottom","top","left","right"];for(this.refreshMinOrMax(),b=0,c=f.length;c>b;b++)for(d=this.axis[f[b]].length-1;d>=0;d--)a=this.axis[f[b]][d],e=2>b?"x":"y",a.disabled||(a.setMinValueData(this.getBoundaryAxisFromSeries(this.axis[f[b]][d],e,"min")),a.setMaxValueData(this.getBoundaryAxisFromSeries(this.axis[f[b]][d],e,"max")))},refreshDrawingZone:function(){var a=["bottom","top","left","right"],b=[0,0,0,0];this._painted=!0,this.refreshMinOrMax(),this.applyToAxes(function(c){if(!c.disabled){var d=a.indexOf(arguments[1]);c.setShift(b[d]+c.getAxisPosition(),c.getAxisPosition()),b[d]+=c.getAxisPosition()}},!1,!0,!1),this.applyToAxes(function(c){if(!c.disabled){c.setMinPx(b[1]),c.setMaxPx(this.getDrawingHeight(!0)-b[0]);var d=c.draw()||0,e=a.indexOf(arguments[1]),f=c.getAxisPosition();c.setShift(b[e]+f+d,d+f),b[e]+=d+f,c.drawSeries()}},!1,!1,!0),this.applyToAxes(function(a){a.disabled||(a.setMinPx(b[2]),a.setMaxPx(this.getDrawingWidth(!0)-b[3]),a.draw(),a.drawSeries())},!1,!0,!1),this.closeLine("right",this.getDrawingWidth(!0),this.getDrawingWidth(!0),b[1],this.getDrawingHeight(!0)-b[0]),this.closeLine("left",0,0,b[1],this.getDrawingHeight(!0)-b[0]),this.closeLine("top",b[2],this.getDrawingWidth(!0)-b[3],0,0),this.closeLine("bottom",b[2],this.getDrawingWidth(!0)-b[3],this.getDrawingHeight(!0)-b[0],this.getDrawingHeight(!0)-b[0]),this.clipRect.setAttribute("y",b[1]),this.clipRect.setAttribute("x",b[2]),this.clipRect.setAttribute("width",this.getDrawingWidth()-b[2]-b[3]),this.clipRect.setAttribute("height",this.getDrawingHeight()-b[1]-b[0]),this.rectEvent.setAttribute("x",b[1]),this.rectEvent.setAttribute("y",b[2]),this.rectEvent.setAttribute("width",this.getDrawingWidth()-b[2]-b[3]),this.rectEvent.setAttribute("height",this.getDrawingHeight()-b[1]-b[0]),this.shift=b,this.redrawShapes()},autoscaleAxes:function(){this.applyToAxes("setMinMaxToFitSeries",null,!0,!0),this.redraw()},closeLine:function(a,b,c,d,e){this.options.close[a]&&0==this.axis[a].length?(this.closingLines[a].setAttribute("display","block"),this.closingLines[a].setAttribute("x1",b),this.closingLines[a].setAttribute("x2",c),this.closingLines[a].setAttribute("y1",d),this.closingLines[a].setAttribute("y2",e)):this.closingLines[a].setAttribute("display","none")},refreshMinOrMax:function(){for(var a=this.series.length-1;a>=0;a--)this.series[a].isMinOrMax(!1)},newSerie:function(a,b,c,d){var e=this;"function"==typeof c&&(c="line",d=c),c||(c="line");var f=g(this,a,b,c,function(a){e.series.push(a),e.legend&&e.legend.update(),d&&d(a)});return f},getSerie:function(a){if("number"==typeof a)return this.series[a];for(var b=0,c=this.series.length;c>b;b++)if(this.series[b].getName()==a)return this.series[b]},getSeries:function(){return this.series},drawSeries:function(){if(this.width&&this.height)for(var a=this.series.length-1;a>=0;a--)this.series[a].draw()},checkMinOrMax:function(a){var b=a.getXAxis(),c=a.getYAxis(),d=a.getMinX(),e=a.getMaxX(),f=a.getMinY(),g=(a.getMaxY(),!1);return d<=b.getMinValue()&&(g=!0,a.isMinOrMax(!0,"x","min")),e>=b.getMaxValue()&&(g=!0,a.isMinOrMax(!0,"x","max")),f<=c.getMinValue()&&(g=!0,a.isMinOrMax(!0,"y","min")),e>=b.getMaxValue()&&(g=!0,a.isMinOrMax(!0,"y","max")),g},removeSerie:function(a){for(var b=this.series.length-1;b>=0;b--)this.series[b]==a&&this.series.slice(b,1);a.removeDom(),a.isMinOrMax()&&this.refreshDrawingZone(),this.legend&&this.legend.update()},setZoomMode:function(a){"x"!=a&&"y"!=a&&"xy"!=a&&a||(this.options.zoomMode=a)},setDefaultWheelAction:function(a){("zoomY"==a||"zoomX"==a||"none"==a)&&(this.options.defaultWheelAction=a)},getZoomMode:function(){return this.options.zoomMode},makeToolbar:function(a){var c=this,d=b.Deferred();return this.dynamicLoader.load("util","./graph.toolbar",function(b){c.toolbar=new b(c,a),d.resolve(c.toolbar)}),d},makeShape:function(a,c,d){var e,f=this,g=b.Deferred();if(a.id=Math.random(),!d||!1!==(e=this.triggerEvent("onShapeBeforeMake",a))){e&&(a=e);{this.dynamicLoader.load("shapes","graph.shape."+a.type,function(b){var d=new b(f,a.shapeOptions);if(d.setSerie(f.getSerie(0)),d){if(d.setOriginalData(a,c),d.data&&(d.data.id=f.id),a.fillColor&&d.set("fillColor",a.fillColor),a.strokeColor&&d.set("strokeColor",a.strokeColor),a.strokeWidth&&d.set("strokeWidth",a.strokeWidth||(a.strokeColor?1:0)),a.label){a.label instanceof Array||(a.label=[a.label]);for(var e=0,h=a.label.length;h>e;e++)d.set("labelPosition",a.label[e].position,e),d.set("labelColor",a.label[e].color||"black",e),d.set("labelSize",a.label[e].size,e),d.set("labelAngle",a.label[e].angle||0,e),a.label[e].anchor&&d.set("labelAnchor",a.label[e].anchor,e);d.setLabelNumber(h)}f.shapes.push(d),f.triggerEvent("onShapeMake",d,a),g.resolve(d)}})}return g}},redrawShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a].redraw()},removeShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a].kill();this.shapes=[]},removeShape:function(a){this.shapes.splice(this.shapes.indexOf(a),1)},_makeClosingLines:function(){this.closingLines={};for(var a,b=["top","bottom","left","right"],c=0,d=4;d>c;c++){var a=document.createElementNS(this.ns,"line");a.setAttribute("stroke","black"),a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("stroke-linecap","square"),a.setAttribute("display","none"),this.closingLines[b[c]]=a,this.graphingZone.appendChild(a)}},_seriesInit:function(){var a=this,b=this.options.series,c=b.length;return 0==c?a._seriesReady():void b.map(function(b){a.dynamicLoader.load("serie","graph.serie."+b,function(){0==--c&&a._seriesReady()})})},_seriesReady:function(){this.seriesReady.resolve()},_pluginsExecute:function(a,b){for(var c in this._plugins)this._plugins[c]&&this._plugins[c][a]&&this._plugins[c][a].apply(this._plugins[c],b)},_pluginExecute:function(a,b,c){this._plugins[a]&&this._plugins[a][b]&&this._plugins[a][b].apply(this._plugins[a],c)},_pluginsInit:function(){var a,b,c=this;if(this._plugins=this._plugins||{},Array.isArray(this.options.plugins))a=this.options.plugins;else{a=[];for(var d in this.options.plugins)a.push(d)}return 0==(b=a.length)?c._pluginsReady():(this.pluginsToLoad=a.length,void this.dynamicLoader.load("plugin",a,function(a,d){c._plugins[d]=new a,c._plugins[d].init(c,c.options.plugins[d]||{},d),0==--b&&c._pluginsReady()}))},getPlugin:function(a){var b=this;return this.pluginsReady.then(function(){return b._plugins[a]||!1})},_pluginsReady:function(){this.pluginsReady.resolve()},triggerEvent:function(){{var a=arguments[0];Array.prototype.splice.apply(arguments,[0,1])}return"function"==typeof this.options[a]?this.options[a].apply(this,arguments):void 0},selectShape:function(a){this.selectedShape!=a&&(this.selectedShape&&this.selectedShape.unselect(),this.selectedShape=a,this.triggerEvent("onShapeSelect",a.data))},unselectShape:function(){this.selectedShape&&(this.selectedShape.unselect(),this.triggerEvent("onShapeUnselect",this.selectedShape.data),this.selectedShape=!1)},selectSerie:function(a){this.selectedSerie!=a&&(this.selectedSerie&&this.selectedSerie.unselect(),this.selectedSerie=a,a.select())},unselectSerie:function(a){a.unselect(),this.selectedSerie=!1},getSelectedSerie:function(){return this.selectedSerie},makeLegend:function(a){return this.legend=new e(this,a),this.graphingZone.appendChild(this.legend.getDom()),this.legend.update(),this.legend},updateLegend:function(){this.legend&&this.legend.update()},getPosition:function(a,b,c,d,e){var f,g={x:!1,y:!1};if(c||(c=this.getXAxis()),d||(d=this.getYAxis()),a){for(var i in g){var j="x"==i?c:d;if(void 0===a[i]&&(void 0!==a["d"+i]&&void 0===b||void 0===b)){if("x"==i){if(void 0===a["d"+i])continue;g[i]=b?b[i]:j.getPos(0)}else if(a.x&&e){var k=e.searchClosestValue(a.x);if(!k)return;g[i]=e.getY(k.yMin)}}else void 0!==a[i]&&(g[i]=this.getPx(a[i],j));if(void 0!==a["d"+i]){var l=void 0!==a[i]||void 0==b||void 0==b[i]?g[i]:this._getPositionPx(b[i],!0,j)||0;(f=h(a["d"+i]))!==!1?g[i]=l+f:(f=this._parsePercent(a["d"+i]))?g[i]=l+this._getPositionPx(f,!0,j):j&&(g[i]=l+j.getRelPx(a["d"+i]))}}return g}},_getPositionPx:function(a,b,c){return(parsed=h(a))?parsed:(parsed=this._parsePercent(a))?parsed/100*(b?this.graph.getDrawingWidth():this.graph.getDrawingHeight()):c?c.getPos(a):void 0},_parsePercent:function(a){return a&&a.indexOf&&a.indexOf("%")>-1?a:!1},deltaPosition:function(a,b,c){var d,e;return(d=h(a))?(e=h(b))?d+e+"px":d+c.getRelPx(b)+"px":(e=h(b))?a+c.getRelVal(e):a+b},getPx:function(a,b,c){var d;return(d=h(a))!==!1?d:(d=this._parsePercent(a))?d:b?"min"==a?b.getMinPx():"max"==a?b.getMaxPx():c?b.getRelPx(a):b.getPos(a):void 0},getPxRel:function(a,b){return this.getPx(a,b,!0)},contextListen:function(a,b,c){var d=this;return this.options.onContextMenuListen?this.options.onContextMenuListen(a,b,c):void(this.context?this.context.listen(a,b,c):this.dynamicLoader.load("util","./util/context",function(e){var f=new e;f.init(d._dom),f.listen(a,b,c),d.context=f}))},lockShapes:function(){this.shapesLocked=!0},unlockShapes:function(){this.shapesLocked=!1}},j.prototype.plugins={},j}(c.jquery,c["graph.axis.x"],c["graph.axis.y"],c["graph.legend"],c.dynamicdepencies),c["graph._serie"]=function(){var a=function(){throw"This serie is not instanciable"};return a.prototype={setAdditionalData:function(a){return this.additionalData=a,this},getAdditionalData:function(){return this.additionalData},kill:function(a){if(this.graph.plotGroup.removeChild(this.groupMain),this.picks&&this.picks.length)for(var b=0,c=this.picks.length;c>b;b++)this.picks[b].kill();this.graph.series.splice(this.graph.series.indexOf(this),1),a||this.graph.redraw()},isMinOrMax:function(a,b,c){return void 0==a?this._isMinOrMax.x.min||this._isMinOrMax.x.max||this._isMinOrMax.y.min||this._isMinOrMax.y.max:void 0==c&&void 0!=b?(this._isMinOrMax[b].min=a,void(this._isMinOrMax[b].max=a)):void(void 0!=b&&void 0!=c&&(this._isMinOrMax[b][c]=a))},hide:function(){this.shown=!1,this.groupMain.setAttribute("display","none"),this.getSymbolForLegend().setAttribute("opacity",.5),this.getTextForLegend().setAttribute("opacity",.5)},show:function(){this.shown=!0,this.groupMain.setAttribute("display","block"),this.getSymbolForLegend().setAttribute("opacity",1),this.getTextForLegend().setAttribute("opacity",1)},toggleShow:function(){return this.shown?void this.hide():void this.show()},isShown:function(){return this.shown},getX:function(a){return Math.round(5*this.getXAxis().getPx(a))/5},getY:function(a){return Math.round(5*this.getYAxis().getPx(a))/5},isSelected:function(){return this.selected},_checkX:function(a){this.minX=Math.min(this.minX,a),this.maxX=Math.max(this.maxX,a)},_checkY:function(a){this.minY=Math.min(this.minY,a),this.maxY=Math.max(this.maxY,a)},getName:function(){return this.name},autoAxis:function(){return this.setXAxis(this.isFlipped()?this.graph.getYAxis():this.graph.getXAxis()),this.setYAxis(this.isFlipped()?this.graph.getXAxis():this.graph.getYAxis()),this.graph.updateAxes(),this},setXAxis:function(a){return this.xaxis="Number"==typeof a?this.isFlipped()?this.graph.getYAxis(a):this.graph.getXAxis(a):a,this},setYAxis:function(a){return"Number"==typeof a?this.xaxis=this.isFlipped()?this.graph.getXAxis(a):this.graph.getYAxis(a):this.yaxis=a,this},getXAxis:function(){return this.xaxis},getYAxis:function(){return this.yaxis},setAxes:function(){for(var a=0;2>a;a++)arguments[a]&&this["x"==arguments[a].isXY()?"setXAxis":"setYAxis"](arguments[a]);return this},getMinX:function(){return this.minX},getMaxX:function(){return this.maxX},getMinY:function(){return this.minY},getMaxY:function(){return this.maxY},getSymbolForLegend:function(){if(!this.lineForLegend){var a=document.createElementNS(this.graph.ns,"line");this.applyLineStyle(a),a.setAttribute("x1",5),a.setAttribute("x2",25),a.setAttribute("y1",0),a.setAttribute("y2",0),a.setAttribute("cursor","pointer"),this.lineForLegend=a}return this.lineForLegend},getTextForLegend:function(){if(!this.textForLegend){var a=document.createElementNS(this.graph.ns,"text");a.setAttribute("transform","translate(35, 3)"),a.setAttribute("cursor","pointer"),a.textContent=this.getLabel(),this.textForLegend=a}return this.textForLegend},getLabel:function(){return this.options.label||this.name},setLabel:function(a){return this.options.label=a,this},setFlip:function(a){this.options.flip=a},getFlip:function(){return this.options.flip},isFlipped:function(){return this.options.flip}},a}(),c["plugins/graph.plugin.drag"]=function(){var a=function(){};return a.prototype={init:function(){},onMouseDown:function(a,b,c){return this._draggingX=b,this._draggingY=c,!0},onMouseMove:function(a,b,c){var d=b-this._draggingX,e=c-this._draggingY;a.applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-d)),a.setCurrentMax(a.getVal(a.getMaxPx()-d))},!1,!0,!1),a.applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-e)),a.setCurrentMax(a.getVal(a.getMaxPx()-e))},!1,!1,!0),this._draggingX=b,this._draggingY=c,a.refreshDrawingZone(!0),a.drawSeries()}},a}(),c["plugins/graph.plugin.linking"]=function(){var a=function(){};return a.prototype={init:function(a,b,c){function d(a){i.islinking=!0;var b=a.graph.isLinking();if(!b){var c=a.graph.newLinkingLine(),d=a.getLinkingCoords();c.setAttribute("x1",d.x),c.setAttribute("y1",d.y),c.setAttribute("x2",d.x),c.setAttribute("y2",d.y),a.graph.linkA(a,c)}}function e(a,b){var c=a.graph.isLinking();if(c&&!a.graph.getLinkingB()){var d=a.graph.getLinkingLine(),e=a.graph.getXY(b);d.setAttribute("x2",e.x-a.graph.getPaddingLeft()),d.setAttribute("y2",e.y-a.graph.getPaddingTop())}}function f(a){var b=a.graph.isLinking();if(b){var c=a.graph.getLinkingA();if(c!=this){a.graph.linkB(a);var d=a.getLinkingCoords(),e=a.graph.getLinkingLine();e.setAttribute("x2",d.x),e.setAttribute("y2",d.y)}}}function g(a){var b=a.graph.isLinking();b&&a.graph.linkB(void 0)}function h(a){return a.graph.endLinking()}this.options=b;var i=this;this.graph=a,this.plugin=c;var j={linkA:function(a,b){this.linking.current.a=a,this.linking.current.line=b},linkB:function(a){this.linking.current.b=a},getLinkingA:function(){return this.linking.current.a},getLinkingB:function(){return this.linking.current.b},isLinking:function(){return!!this.linking.current.a},newLinkingLine:function(){var a=document.createElementNS(this.ns,"line");return a.setAttribute("class","graph-linkingline"),this.shapeZone.insertBefore(a,this.shapeZone.firstChild),a},getLinkingLine:function(){return this.linking.current.line},endLinking:function(){return this.linking.current.a==this.linking.current.b&&this.linking.current.a||!this.linking.current.b&&this.linking.current.a?(this.shapeZone.removeChild(this.linking.current.line),void(this.linking.current={})):(this.linking.current.line&&(this.linking.current.line.style.display="none",this.linking.links.push(this.linking.current),this.linking.current={}),this.linking.links[this.linking.links.length-1])},linkingReveal:function(){for(var a=0,b=this.linking.links.length;b>a;a++)this.linking.links[a].line.style.display="block"},linkingHide:function(){for(var a=0,b=this.linking.links.length;b>a;a++)this.linking.links[a].line.style.display="none"}};for(var k in j)a[k]=j[k];a.linking={current:{},links:[]},a.shapeHandlers.mouseDown.push(function(a){i.graph.allowPlugin(a,i.plugin)&&(this.moving=!1,this.handleSelected=!1,d(this,a,!0))}),a.shapeHandlers.mouseUp.push(function(){var a;(a=h(this))&&(a.a.linking=a.a.linking||0,a.a.linking++,a.b.linking=a.b.linking||0,a.b.linking++,a.a.addClass("linking"),a.b.addClass("linking"),a.a.addClass("linking"+a.a.linking),a.a.removeClass("linking"+(a.a.linking-1)),a.b.addClass("linking"+a.a.linking),a.b.removeClass("linking"+(a.a.linking-1)),i.options.onLinkCreate&&i.options.onLinkCreate(a.a,a.b))}),a.shapeHandlers.mouseMove.push(function(a){e(this,a,!0)}),a.shapeHandlers.mouseOver.push(function(a){f(this,a,!0)}),a.shapeHandlers.mouseOut.push(function(a){g(this,a,!0)})}},a}(),c["plugins/graph.plugin.nmrpeakpicking"]=function(){var a=function(){};return a.prototype={init:function(a){this.graph=a},process:function(){this.graph.makeShape({type:"rect",pos:{x:0,y:1e3},pos2:{x:10,y:1e8},fillColor:[100,100,100,.3],strokeColor:[100,100,100,.9],strokeWidth:1}).then(function(a){a.draw(),a.redraw()})}},a}(),c["plugins/graph.plugin.range"]=function(){var a=function(){};return a.prototype={init:function(){},onMouseDown:function(a,b,c,d){var e=a;if(this.count=this.count||0,this.count!=a.options.rangeLimitX){b-=a.getPaddingLeft(),xVal=a.getXAxis().getVal(b);var f=a.makeShape({type:"rangeX",pos:{x:xVal,y:0},pos2:{x:xVal,y:0}},{onChange:function(a){e.triggerEvent("onAnnotationChange",a)}},!0);require&&require(["src/util/context"],function(a){a.listen(f._dom,[['<li><a><span class="ui-icon ui-icon-cross"></span> Remove range zone</a></li>',function(){f.kill()}]])});var g=Util.getNextColorRGB(this.count,a.options.rangeLimitX);f.set("fillColor","rgba("+g+", 0.3)"),f.set("strokeColor","rgba("+g+", 0.9)"),this.count++,f.handleMouseDown(d,!0),f.draw()}}},a}(),c["plugins/graph.plugin.shape"]=function(){var a=function(){};return a.prototype={init:function(a,b){this.options=b,this.shapeType=b.type},setShape:function(a){this.shapeInfo.shapeType=a},onMouseDown:function(a,c,d,e){if(this.shapeType){var f,g,h=this;this.count=this.count||0,c-=a.getPaddingLeft(),d-=a.getPaddingTop(),f=a.getXAxis().getVal(c),g=a.getYAxis().getVal(d);{var i={pos:{x:f,y:g},pos2:{x:f,y:g},onChange:function(b){a.triggerEvent("onAnnotationChange",b)}};a.makeShape(b.extend(i,this.options),{},!0).then(function(a){a&&(h.currentShape=a,h.currentShapeEvent=e)})}}},onMouseMove:function(a,b,c,d){var e=this;if(e.currentShape){e.count++;var f=e.currentShape;e.currentShape=!1,f.handleCreateImpl(),f.options&&f.options.onCreate&&f.options.onCreate.call(f),f.draw(),f.select(),f.handleMouseDown(e.currentShapeEvent,!0),f.handleMouseMove(d,!0)}},onMouseUp:function(){var a=this;a.currentShape&&(a.currentShape.kill(),a.currentShape=!1)}},a}(),c["plugins/graph.plugin.zoom"]=function(){var a=function(){};return a.prototype={init:function(a,b){this._zoomingGroup=document.createElementNS(a.ns,"g"),this._zoomingSquare=document.createElementNS(a.ns,"rect"),this._zoomingSquare.setAttribute("display","none"),a.setAttributeTo(this._zoomingSquare,{display:"none",fill:"rgba(171,12,12,0.2)",stroke:"rgba(171,12,12,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0}),this.options=b,this.graph=a,a.dom.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)},onMouseDown:function(a,b,c,d,e){var f=this.options.zoomMode;if(f){switch(this._zoomingMode=f,void 0===b&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="y",b=0),void 0===c&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="x",c=0),this._zoomingXStart=b,this._zoomingYStart=c,this.x1=b-a.getPaddingLeft(),this.y1=c-a.getPaddingTop(),this._zoomingSquare.setAttribute("width",0),this._zoomingSquare.setAttribute("height",0),this._zoomingSquare.setAttribute("display","block"),this._zoomingMode){case"x":this._zoomingSquare.setAttribute("y",a.options.paddingTop),this._zoomingSquare.setAttribute("height",a.getDrawingHeight()-a.shift[0]);break;case"y":this._zoomingSquare.setAttribute("x",a.options.paddingLeft),this._zoomingSquare.setAttribute("width",a.getDrawingWidth())}this.options.onZoomStart&&!e&&this.options.onZoomStart(a,b,c,d,e)}},onMouseMove:function(a,b,c,d,e){switch(this._zoomingMode){case"xy":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c));break;case"x":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b));break;case"y":this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c))}this.options.onZoomMove&&!e&&this.options.onZoomMove(a,b,c,d,e)},onMouseUp:function(a,b,c,d,e){this._zoomingSquare.setAttribute("display","none");var f=b-a.options.paddingLeft,g=c-a.options.paddingTop;if(!(b-this._zoomingXStart==0&&"y"!=this._zoomingMode||c-this._zoomingYStart==0&&"x"!=this._zoomingMode)){switch(this._zoomingMode){case"x":a.applyToAxes("_doZoom",[f,this.x1],!0,!1);break;case"y":a.applyToAxes("_doZoom",[g,this.y1],!1,!0);break;case"xy":a.applyToAxes("_doZoom",[f,this.x1],!0,!1),a.applyToAxes("_doZoom",[g,this.y1],!1,!0)}a.redraw(!0),a.drawSeries(),this.options.onZoomEnd&&!e&&this.options.onZoomEnd(a,b,c,d,e),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode)}},onMouseWheel:function(a,b){var c;return(c=this.graph.getSelectedSerie())?void c.getYAxis().handleMouseWheel(a,b):void this.graph.applyToAxes("handleMouseWheel",[a,b],!1,!0)},onDblClick:function(a,b,c,d,e,f){var g=this.graph.getXAxis(),h=this.graph.getYAxis();if("xtotal"==d.mode)this.graph.applyToAxes("setMinMaxToFitSeries",null,!0,!1),this.graph.drawSeries();else if("ytotal"==d.mode)this.graph.applyToAxes("setMinMaxToFitSeries",null,!1,!0),this.graph.drawSeries();else if("total"==d.mode)this.graph.autoscaleAxes(),this.graph.drawSeries(),h.options.onZoom&&h.options.onZoom(h.getMinValue(),h.getMaxValue()),g.options.onZoom&&g.options.onZoom(g.getMinValue(),g.getMaxValue());else{b-=this.graph.options.paddingLeft,c-=this.graph.options.paddingTop;var i=g.getActualMin(),j=g.getActualMax(),k=g.getVal(b),l=j-i,m=h.getActualMin(),n=h.getActualMax(),o=h.getVal(c),p=n-m;if("gradualXY"==d.mode||"gradualX"==d.mode){var q=(k-i)/(j-i);i=Math.max(g.getMinValue(),i-l*q),j=Math.min(g.getMaxValue(),j+l*(1-q)),g.setCurrentMin(i),g.setCurrentMax(j),g.options.onZoom&&g.options.onZoom(i,j)}if("gradualXY"==d.mode||"gradualY"==d.mode){var q=(o-m)/(n-m);m=Math.max(h.getMinValue(),m-p*q),n=Math.min(h.getMaxValue(),n+p*(1-q)),h.setCurrentMin(m),h.setCurrentMax(n),h.options.onZoom&&h.options.onZoom(m,n)}this.graph.redraw(),this.graph.drawSeries()}this.options.onDblClick&&!f&&this.options.onDblClick(b,c,d,e)}},a}(),c["series/graph.serie.line"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{lineColor:"black",lineStyle:1,flip:!1,label:"",markers:{show:!1,type:1,zoom:1,strokeColor:!1,strokeWidth:1,fillColor:"transparent"},trackMouse:!1,trackMouseLabel:!1,trackMouseLabelRouding:1,lineToZero:!1,lineWidth:1,autoPeakPicking:!1,autoPeakPickingNb:4,autoPeakPickingMinDistance:10},init:function(a,d,e){var f=this;this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupLines=document.createElementNS(this.graph.ns,"g"),this.domMarker=document.createElementNS(this.graph.ns,"path"),this.domMarker.style.cursor="pointer",this.groupMain=document.createElementNS(this.graph.ns,"g"),this.additionalData={},this.domMarker.addEventListener("mouseover",function(a){var b=f._getMarkerIndexFromEvent(a);f.onMouseOverMarker(a,b)}),this.domMarker.addEventListener("mouseout",function(a){var b=f._getMarkerIndexFromEvent(a);f.onMouseOutMarker(a,b)}),this.domMarker.addEventListener("click",function(a){var b=f._getMarkerIndexFromEvent(a);f.onClickOnMarker(a,b)}),this.marker=document.createElementNS(this.graph.ns,"circle"),this.marker.setAttribute("fill","black"),this.marker.setAttribute("r",3),this.marker.setAttribute("display","none"),this.markerLabel=document.createElementNS(this.graph.ns,"text"),this.markerLabelSquare=document.createElementNS(this.graph.ns,"rect"),this.markerLabelSquare.setAttribute("fill","white"),this.domMarkerHover={},this.domMarkerSelect={},this.markerHovered=0,this.groupMarkerSelected=document.createElementNS(this.graph.ns,"g"),this.groupLabels=document.createElementNS(this.graph.ns,"g"),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.lines=[],this.groupMain.appendChild(this.groupLines),this.groupMain.appendChild(this.groupLabels),this.groupMain.appendChild(this.marker),this.groupMain.appendChild(this.domMarker),this.groupMain.appendChild(this.groupMarkerSelected),this.groupMain.appendChild(this.markerLabelSquare),this.groupMain.appendChild(this.markerLabel),this.labels=[],this.currentAction=!1,this.initExtended1&&this.initExtended1()},setData:function(a,b,c){var d,e,f,g,h=0,b=b||"2D",c=c||"float",i=0;if(!(!a instanceof Array)){var j=[];a instanceof Array||"object"!=typeof a?a instanceof Array&&!(a[0]instanceof Array)&&(a=[a],b="1D"):a=[a];var k="2D"==b;if(a[0]instanceof Array&&"2D"==b&&!(a[0][0]instanceof Array)&&(a=[a]),a[0]instanceof Array)for(var l=0,m=a.length;m>l;l++){f=this._addData(c,k?2*a[l].length:a[l].length),j.push(f),h=0;
for(var n=0,o=a[l].length;o>n;n++)k?(f[h]=a[l][n][0],this._checkX(f[h]),h++,f[h]=a[l][n][1],this._checkY(f[h]),h++,i++):(f[h]=a[l][n],this[n%2==0?"_checkX":"_checkY"](f[h]),h++,i+=n%2?1:0)}else if("object"==typeof a[0]){this.mode="x_equally_separated";for(var p,q=0,r=[],j=[],m=0,l=0,o=a.length;o>l;l++)q+=a[l].y.length,g=0!=l&&(!a[l+1]||a[l].x+a[l].dx*a[l].y.length==a[l+1].x),g||(j.push(this._addData(c,q)),r.push(q),q=0);this.xData=[],q=0,m=0,h=0;for(var l=0,o=a.length;o>l;l++){d=a[l].x,e=a[l].dx,this.xData.push({x:d,dx:e}),p=a[l].y.length,this._checkX(d),this._checkX(d+e*p);for(var n=0;p>n;n++)j[m][h]=a[l].y[n],this._checkY(j[m][h]),h++,i++;q+=a[l].y.length,r[m]==q&&(m++,q=0,h=0)}}var s=((this.maxX-this.minX)/this.graph.getDrawingWidth(),[]),t=4*this.graph.getDrawingWidth(),u=i/4,t=this.graph.getDrawingWidth(),u=i;if(this.data=j,t>0){for(;u>t;)s.push(t),t*=4;this.slots=s,this.options.useSlots&&this.calculateSlots()}if(this.isFlipped()){var v=this.maxX,w=this.maxY,x=this.minX,y=this.minY;this.maxX=w,this.maxY=v,this.minX=y,this.minY=x}return this.graph.updateAxes(),this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},setAdditionalData:function(a){return this.additionalData=a,this},getAdditionalData:function(){return this.additionalData},calculateSlots:function(){var a=this;this.slotsData={},this.slotWorker=new Worker("./src/slotworker.js"),this.slotWorker.onmessage=function(b){a.slotsData[b.data.slot].resolve(b.data.data)};for(var b=0,c=this.slots.length;c>b;b++)this.calculateSlot(this.slots[b],b)},slotCalculator:function(a,c){var d=b.Deferred();return this.slotWorker.postMessage({min:this.minX,max:this.maxX,data:this.data,slot:a,slotNumber:c,flip:this.getFlip()}),d},calculateSlot:function(a,b){var c=this;this.slotsData[a]=this.slotCalculator(a,b),this.slotsData[a].pipe(function(b){return c.slotsData[a]=b,b})},kill:function(a){if(this.graph.plotGroup.removeChild(this.groupMain),this.picks&&this.picks.length)for(var b=0,c=this.picks.length;c>b;b++)this.picks[b].kill();this.graph.series.splice(this.graph.series.indexOf(this),1),a||this.graph.redraw()},onMouseOverMarker:function(a,b){this.toggleMarker(b,!0,!0);this.options.onMouseOverMarker&&this.options.onMouseOverMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},onMouseOutMarker:function(a,b){this.markersOffHover(),this.options.onMouseOutMarker&&this.infos&&this.options.onMouseOutMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},toggleMarker:function(a,b,c){var d=a[0],e=a[1]||0;a=a.join();var f=c?!this.domMarkerHover[a]:!this.domMarkerSelect[a],g=this["domMarker"+(c?"Hover":"Select")];if(f||b===!0&&b!==!1){if(!g[a]){var h=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(h,!0);var i=this.getX(this.data[e][2*d]),j=this.getY(this.data[e][2*d+1]);h.setAttribute("d","M "+i+" "+j+" "+this.getMarkerPath(this.options.markers.zoom+1).join(" ")),this["domMarker"+(c?"Hover":"Select")][a]=h,this.groupMarkerSelected.appendChild(h),c&&this.markerHovered++}}else if((b===!1||!f)&&(c&&this.domMarkerHover[a]&&!this.domMarkerSelect[a]||this.domMarkerSelect[a])){if(!g[a])return;this.groupMarkerSelected.removeChild(g[a]),delete g[a],c&&this.markerHovered--}return f},markersOffHover:function(){for(var a in this.domMarkerHover)this.toggleMarker(a.split(","),!1,!0)},onClickOnMarker:function(a,b){var c=this.toggleMarker(b);c&&this.options.onSelectMarker&&this.options.onSelectMarker(b,this.infos?this.infos[b[0]]||!1:!1),!c&&this.options.onUnselectMarker&&this.options.onUnselectMarker(b,this.infos?this.infos[b[0]]||!1:!1),this.options.onToggleMarker&&this.options.onToggleMarker(b,this.infos?this.infos[b[0]]||!1:!1,c)},_getMarkerIndexFromEvent:function(a){var b=this.graph.getXY(a);return this.searchIndexByPxXY(b.x-this.graph.getPaddingLeft(),b.y-this.graph.getPaddingTop())},onMouseWheel:function(){},empty:function(){for(var a=0,b=this.lines.length;b>a;a++)this.groupLines.removeChild(this.lines[a]);for(;this.groupMarkers.firstChild;)this.groupMarkers.removeChild(this.groupMarkers.firstChild)},select:function(){this.selected=!0;for(var a=0,b=this.lines.length;b>a;a++)this.applyLineStyle(this.lines[a]);this.applyLineStyle(this.getSymbolForLegend())},unselect:function(){this.selected=!1;for(var a=0,b=this.lines.length;b>a;a++)this.applyLineStyle(this.lines[a]);this.applyLineStyle(this.getSymbolForLegend())},draw:function(){var a,b,c,d,e,f,g,h,i=0,j=this.data.length,k=0,l=this;this.picks=this.picks||[];var m;if(this.options.autoPeakPicking)for(var n=0,g=this.options.autoPeakPickingNb;g>n;n++)m=this.graph.makeShape({type:"label",label:{text:"",position:{x:0},anchor:"middle"}}),m.setSerie(this),this.picks.push(m);this._drawn=!0;var o=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.groupMain.removeChild(this.domMarker),this.marker.setAttribute("display","none"),this.markerPath="",this._markerPath=this.getMarkerPath().join(" ");var p=0,q=1;this.isFlipped()&&(p=1,q=0);for(var r=0;j>i;i++)r+=this.data[i].length/2;i=0;var s,t,u=[],a=0;if(this.options.useSlots&&this.slots)for(var v=this.graph.getDrawingWidth()*(this.maxX-this.minX)/(this.getXAxis().getActualMax()-this.getXAxis().getActualMin()),a=0,t=this.slots.length;t>a;a++)if(v<this.slots[a]){s=this.slotsData[this.slots[a]];break}if(s)s.done?s.done(function(b){l.drawSlot(b,a)}):this.drawSlot(s,a);else if("x_equally_separated"==this.mode)for(;j>i;i++){for(h="M ",k=0,f=0,g=this.data[i].length;g>k;k+=1)this.isFlipped()?(c=this.getX(this.xData[i].x+k*this.xData[i].dx),b=this.getY(this.data[i][k])):(b=this.getX(this.xData[i].x+k*this.xData[i].dx),c=this.getY(this.data[i][k])),h=this._addPoint(h,b,c,f),f++;this._createLine(h,i,f)}else for(;j>i;i++){for(h="M ",k=0,f=0,g=this.data[i].length;g>k;k+=2)d=this.getX(this.data[i][k+p]),e=this.getY(this.data[i][k+q]),(d!=b||e!=c)&&(this.options.autoPeakPicking&&u.push([this.data[i][k+q],this.data[i][k+p]]),h=this._addPoint(h,d,e,f),f++,b=d,c=e);this._createLine(h,i,f)}for(this.options.autoPeakPicking&&this.makePeakPicking(u),i++;i<this.lines.length;i++)this.groupLines.removeChild(this.lines[i]),this.lines.splice(i,1);this.setMarkerStyleTo(this.domMarker),this.domMarker.setAttribute("d",this.markerPath||"M 0 0"),this.groupMain.appendChild(this.domMarker),this.groupMain.insertBefore(this.groupLines,o);for(var i=0,j=this.labels.length;j>i;i++)this.repositionLabel(this.labels[i])},drawSlot:function(a,b){var c=this.slots[b]/(this.maxX-this.minX),d="M ";k=0;var e,f,g,h=0,i=Math.floor((this.getXAxis().getActualMin()-this.minX)*c),j=Math.ceil((this.getXAxis().getActualMax()-this.minX)*c);for(g=i;j>=g;g++)a[g]&&(e=Math.floor(this.getX(a[g].x)),f=this.getY(a[g].max),this.options.autoPeakPicking&&allY.push([a[g].max,a[g].x]),d=this._addPoint(d,e,this.getY(a[g].start),k),d=this._addPoint(d,e,f,!1,!0),d=this._addPoint(d,e,this.getY(a[g].min)),d=this._addPoint(d,e,this.getY(a[g].stop),!1,!0),k++);this._createLine(d,h,k),h++,console.timeEnd("Slot")},setMarkerStyleTo:function(a,b){a.setAttribute("fill",b?"transparent":this.options.markers.fillColor||"transparent"),a.setAttribute("stroke",this.options.markers.strokeColor||this.getLineColor()),a.setAttribute("stroke-width",this.options.markers.strokeWidth)},makePeakPicking:function(a){var b,c,c,d,e,f,g=[],h=0,i=a.length;for(a.sort(function(a,b){return b[0]-a[0]});i>h;h++)if(b=a[h][1],c=this.getX(b),d=0,e=g.length,f=this.getY(a[h][0]),!(c<this.getXAxis().getMinPx()||c>this.getXAxis().getMaxPx()||f>this.getYAxis().getMinPx()||f<this.getYAxis().getMaxPx())){for(;e>d&&!(Math.abs(g[d]-c)<this.options.autoPeakPickingMinDistance);d++);if(!(e>d)&&(this.picks[e].set("labelPosition",{x:b,dy:"-10px"}),this.picks[e].data.label[0].text=String(Math.round(1e3*b)/1e3),g.push(c),g.length==this.options.autoPeakPickingNb))break}this.graph.redrawShapes()},hideTrackingMarker:function(){this.marker.setAttribute("display","none"),this.markerLabel.setAttribute("display","none"),this.markerLabelSquare.setAttribute("display","none")},_addPoint:function(a,b,c,d,e){var f;return 0!==d&&(a+=this.options.lineToZero||e?"M ":"L "),a+=b,a+=" ",a+=c,a+=" ",this.options.lineToZero&&void 0!==(f=this.getYAxis().getPos(0))&&(a+="L ",a+=b,a+=" ",a+=f,a+=" "),this.options.markers.show?(b>this.getXAxis().getMaxPx()||b<this.getXAxis().getMinPx()||this._drawMarkerXY(b,c),a):a},_createLine:function(a,b,c){if(this.lines[b])var d=this.lines[b];else{var d=document.createElementNS(this.graph.ns,"path");this.applyLineStyle(d)}return 0==c?d.setAttribute("d","M 0 0"):d.setAttribute("d",a),this.lines[b]||(this.groupLines.appendChild(d),this.lines[b]=d),d},applyLineStyle:function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()+(this.isSelected()?2:0)),this.getLineDashArray()&&a.setAttribute("stroke-dasharray",this.getLineDashArray()),a.setAttribute("fill","none")},getMarkerPath:function(a,b){var c,d=a||this.options.markers.zoom,b=b||0;switch(this.options.markers.type){case 1:c=["m",-2,-2,"l",4,0,"l",0,4,"l",-4,0,"z"];break;case 2:c=["m",-2,-2,"l",4,4,"l",-4,0,"l",4,-4,"z"]}if(!(1!=d&&d||b))return c;for(var e="number",f=0,g=c.length;g>f;f++)typeof c[f]==e&&(c[f]*=d);return c},_drawMarkerXY:function(a,b){this.options.markers.show&&(this.markerPath+="M "+a+" "+b+" ",this.markerPath+=this._markerPath+" ")},handleLabelMove:function(a,b){var c=this.labelDragging;c&&(c.labelX+=a-c.draggingIniX,c.draggingIniX=a,c.labelY+=b-c.draggingIniY,c.draggingIniY=b,c.rect.setAttribute("x",c.labelX),c.rect.setAttribute("y",c.labelY-this.graph.options.fontSize),c.labelDom.setAttribute("x",c.labelX),c.labelDom.setAttribute("y",c.labelY),c.labelLine.setAttribute("x1",c.labelX+c.labelDom.getComputedTextLength()/2),c.labelLine.setAttribute("y1",c.labelY-this.graph.options.fontSize/2))},handleLabelMainMove:function(a){var b=this.labelDragging;b.x=this.getXAxis().getVal(a-this.graph.options.paddingLeft),b.y=this.handleMouseMove(b.x,!1).interpolatedY,this.repositionLabel(b,!0)},handleLabelUp:function(){this.labelDragging=!1},searchIndexByPxXY:function(a,b){for(var c,d=!1,e=!1,f=0,g=this.data.length;g>f;f++)for(var h=0,i=this.data[f].length;i>h;h+=2)c=Math.pow(this.getX(this.data[f][h])-a,2)+Math.pow(this.getY(this.data[f][h+1])-b,2),(!d||d>c)&&(d=c,e=[h/2,f]);return e},searchClosestValue:function(a){for(var b,c=0;c<this.data.length;c++){if(a<=this.data[c][this.data[c].length-2]&&a>this.data[c][0])b=this._searchBinary(a,this.data[c],!1);else{if(!(a>=this.data[c][this.data[c].length-2]&&a<this.data[c][0]))continue;b=this._searchBinary(a,this.data[c],!0)}return{dataIndex:c,xMin:this.data[c][b],xMax:this.data[c][b+2],yMin:this.data[c][b+1],yMax:this.data[c][b+3],xBeforeIndex:b/2,xAfterIndex:b/2+2,xBeforeIndexArr:b}}},handleMouseMove:function(a,b){var c,d=a||this.getXAxis().getMouseVal(),e=this.searchClosestValue(d);if(e){var f=(d-e.xMin)/(e.xMax-e.xMin),g=(1-f)*e.yMin+f*e.yMax;if(b&&this.options.trackMouse){if(!c)return!1;var a=this.getX(this.getFlip()?g:d),h=this.getY(this.getFlip()?d:g);switch(this.marker.setAttribute("display","block"),this.marker.setAttribute("cx",a),this.marker.setAttribute("cy",h),this.markerLabel.setAttribute("display","block"),this.markerLabelSquare.setAttribute("display","block"),this.options.trackMouseLabel){case!1:break;default:this.markerLabel.textContent=this.options.trackMouseLabel.replace("<x>",d.toFixed(this.options.trackMouseLabelRouding)).replace("<y>",g.toFixed(this.options.trackMouseLabelRouding))}this.markerLabel.setAttribute("x",a+5),this.markerLabel.setAttribute("y",h-5),this.markerLabelSquare.setAttribute("x",a+5),this.markerLabelSquare.setAttribute("y",h-5-this.graph.options.fontSize),this.markerLabelSquare.setAttribute("width",this.markerLabel.getComputedTextLength()+2),this.markerLabelSquare.setAttribute("height",this.graph.options.fontSize+2)}return{xBefore:e.xMin,xAfter:e.xMax,yBefore:e.yMin,yAfter:e.yMax,trueX:d,interpolatedY:g,xBeforeIndex:e.xBeforeIndex}}},_searchBinary:function(a,b,c){var d=0,e=b.length,f=e-2;if(b[d]==a)return d;if(b[f]==a)return f;for(var g,h=0;;){if(h++,h>100)throw"Error loop";if(g=(d+f)/2,g-=g%2,g==d||b[g]==a)return g;b[g]<=a?c?f=g:d=g:b[g]>a&&(c?d=g:f=g)}},getMax:function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=0;for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=2)k=Math.max(k,this.data[c][d+1]);return k},setLineStyle:function(a){this.options.lineStyle=a},getLineStyle:function(){return this.options.lineStyle},getLineDashArray:function(){switch(this.options.lineStyle){case 2:return"5, 5";case!1:case 1:return!1;default:return this.options.lineStyle}},setLineWidth:function(a){return this.options.lineWidth=a,this},getLineWidth:function(){return this.options.lineWidth},setLineColor:function(a){return this.options.lineColor=a,this},getLineColor:function(){return this.options.lineColor},showMarkers:function(a){return this.options.markers.show=!0,!a&&this._drawn&&this.draw(),this},hideMarkers:function(a){return this.options.markers.show=!1,!a&&this._drawn&&this.draw(),this},markersShown:function(){return this.options.markers.show},setMarkerType:function(a,b){return this.options.markers.type=a,!b&&this._drawn&&this.draw(),this},setMarkerZoom:function(a,b){return this.options.markers.zoom=a,!b&&this._drawn&&this.draw(),this},setMarkerStrokeColor:function(a,b){this.options.markers.strokeColor=a,!b&&this._drawn&&this.draw()},setMarkerStrokeWidth:function(a,b){this.options.markers.strokeWidth=a,!b&&this._drawn&&this.draw()},setMarkerFillColor:function(a,b){this.options.markers.fillColor=a,!b&&this._drawn&&this.draw()},addLabelX:function(a,b){this.addLabelObj({x:a,label:b})},addLabel:function(a,b,c){this.addLabelObj({x:a,y:b,label:c})},repositionLabel:function(a,b){var c=this.getFlip()?this.getY(a.x):this.getX(a.x),d=this.getFlip()?this.getX(a.y):this.getY(a.y),e=isNaN(c)||isNaN(d);a.group.setAttribute("display",e?"none":"block"),b&&(a.labelDom.textContent=this.options.label.replace("<x>",a.x.toFixed(this.options.trackMouseLabelRouding)||"").replace("<label>",a.label||""),a.rect.setAttribute("width",a.labelDom.getComputedTextLength()+2)),e||a.group.setAttribute("transform","translate("+c+" "+d+")")},addLabelObj:function(a){var b,c,d,e;this.labels.push(a),a.x&&!a.y&&(a.y=this.handleMouseMove(a.x,!1).interpolatedY),b=document.createElementNS(this.graph.ns,"g"),this.groupLabels.appendChild(b),c=document.createElementNS(this.graph.ns,"text"),c.setAttribute("x",5),c.setAttribute("y",-5);var f=document.createElementNS(this.graph.ns,"line");f.setAttribute("stroke","black"),f.setAttribute("x2",0),f.setAttribute("x1",0),b.appendChild(f),b.appendChild(c),d=document.createElementNS(this.graph.ns,"rect"),d.setAttribute("x",5),d.setAttribute("y",-this.graph.options.fontSize-5),d.setAttribute("width",c.getComputedTextLength()+2),d.setAttribute("height",this.graph.options.fontSize+2),d.setAttribute("fill","white"),d.style.cursor="move",c.style.cursor="move",e=document.createElementNS(this.graph.ns,"path"),e.setAttribute("d","M 0 -4 l 0 8 m -4 -4 l 8 0"),e.setAttribute("stroke-width","1px"),e.setAttribute("stroke","black"),e.style.cursor="move",b.insertBefore(d,c),b.appendChild(e),a.labelLine=f,a.group=b,a.rect=d,a.labelDom=c,a.path=e,a.labelY=-5,a.labelX=5,this.bindLabelHandlers(a),this.repositionLabel(a,!0)},bindLabelHandlers:function(a){function b(b){if(d.graph.currentAction===!1){d.graph.currentAction="labelDragging",b.stopPropagation(),a.dragging=!0;var c=d.graph.getXY(b);a.draggingIniX=c.x,a.draggingIniY=c.y,d.labelDragging=a}}function c(b){d.graph.currentAction===!1&&(b.stopPropagation(),b.preventDefault(),d.graph.currentAction="labelDraggingMain",d.labelDragging=a)}var d=this;a.labelDom.addEventListener("mousedown",b),a.rect.addEventListener("mousedown",b),a.rect.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.labelDom.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.path.addEventListener("mousedown",c),a.path.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()})},getMarkerForLegend:function(){if(this.markersShown()){if(!this.markerForLegend){var a=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(a,!0),a.setAttribute("d","M 14 0 "+this.getMarkerPath(this.options.markers.zoom+1).join(" ")),this.markerForLegend=a}return this.markerForLegend}}}),c}(c["graph._serie"]),c["series/graph.serie.contour"]=function(a){var c=function(){this.accumulatedDelta=0,this.threshold=0};return b.extend(c.prototype,a.prototype,{setData:function(a,b,c){var d,e,c=c||"float",f=a.length,g=[];if(!(!a instanceof Array)){for(var d=0;f>d;d++){k=k=a[d].lines.length,e=this._addData(c,k);for(var h=0;k>h;h+=2)e[h]=a[d].lines[h],this._checkX(e[h]),e[h+1]=a[d].lines[h+1],this._checkY(e[h+1]);g.push({lines:e,zValue:a[d].zValue})}return this.data=g,this}},draw:function(){var a,b,c,d,e,f,g,h,i,j=0,k=this.data.length,l=0;this.minZ=-Number.MAX_VALUE,this.maxZ=Number.MAX_VALUE;var m=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.zValues={};var n=0,o=1;for(this.getFlip()&&(n=0,o=1);k>j;j++){for(l=0,e=0,g="",i=this.data[j].lines,f=i.length;f>l;l+=4){var p,q;c=this.getX(i[l+n]),d=this.getY(i[l+o]),a=this.getX(i[l+2+n]),b=this.getY(i[l+2+o]),(a!=c||b!=d)&&(g+=l>0&&void 0!==p&&void 0!==q&&Math.abs(c-p)<=30&&Math.abs(d-q)<=30?"L":"M",g+=c,g+=" ",g+=d,g+="L",g+=a,g+=" ",g+=b,p=a,q=b,e++)}h=this._createLine(g+" z",j,e),h.setAttribute("data-zvalue",this.data[j].zValue),this.zoneColors&&this.zoneColors[j]&&h.setAttribute("fill",this.zoneColors[j]),this.zValues[this.data[j].zValue]={dom:h},this.minZ=Math.max(this.minZ,this.data[j].zValue),this.maxZ=Math.min(this.maxZ,this.data[j].zValue)}for(j++;j<this.lines.length;j++)this.groupLines.removeChild(this.lines[j]),this.lines.splice(j,1);this.groupMain.insertBefore(this.groupLines,m)},onMouseWheel:function(a){this.accumulatedDelta=Math.min(1,Math.max(-1,this.accumulatedDelta+Math.min(.1,Math.max(-.1,a)))),this.threshold=Math.max(-this.minZ,this.maxZ)*Math.pow(this.accumulatedDelta,3);for(var b in this.zValues)this.zValues[b].dom.setAttribute("display",Math.abs(b)<this.threshold?"none":"block")},setColors:function(a){this.zoneColors=a}}),c}(c["series/graph.serie.line"]),c["series/graph.serie.scatter"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{label:""},init:function(a,d,e){this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupPoints=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.errorPath=document.createElementNS(this.graph.ns,"path"),this.errorPath.setAttribute("stroke","black"),this.errorPath.setAttribute("fill","transparent"),this.errorPath.setAttribute("stroke-width","1px"),this.groupMain.appendChild(this.errorPath),this.additionalData={},this.groupPoints.addEventListener("mouseover",function(){}),this.groupPoints.addEventListener("mouseout",function(){}),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupPoints),this.currentAction=!1,this.initExtended1&&this.initExtended1(),this.stdStyle={shape:"circle",cx:0,cy:0,r:3,stroke:"transparent",fill:"black"}},setData:function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(!(!a instanceof Array)){a instanceof Array&&!(a[0]instanceof Array)&&(b="1D");var g="2D"==b;d=this._addData(c,g?2*a.length:a.length),e=0;for(var h=0,i=a.length;i>h;h++)g?(d[e]=a[h][0],this._checkX(d[e]),e++,d[e]=a[h][1],this._checkY(d[e]),e++,f++):(d[e]=a[h],this[h%2==0?"_checkX":"_checkY"](d[e]),e++,f+=h%2?1:0);return this.graph.updateAxes(),this.data=d,this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},empty:function(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)},select:function(){this.selected=!0},unselect:function(){this.selected=!1},setDataStyle:function(a,b){return this.stdStylePerso=a,this.extraStyle=b,this},draw:function(){var a,b,c,d,e=0;this._drawn=!0,this.groupMain.removeChild(this.groupPoints);var f=0,g=1;this.getFlip()&&(f=1,g=0);this.data.length/2;e=0,c=0,d=this.data.length;for(var h,i="";d>e;e+=2){a=this.getX(this.data[e+f]),b=this.getY(this.data[e+g]);{this.data[e+g]}this.error&&(h=this.error[e/2])&&(i+="M "+a+" "+b,h[0]&&(i+=this.doErrorDraw("y",h[0],this.data[e+g],b,i)),h[1]&&(i+=this.doErrorDraw("x",h[1],this.data[e+f],a,i))),this._addPoint(a,b,e/2)}this.errorPath.setAttribute("d",i),this.groupMain.appendChild(this.groupPoints)},doErrorDraw:function(a,b,c,d,e){b instanceof Array||(b=[b]);for(var f="y"==a?"getY":"getX",g=0,h=b.length;h>g;g++)b[g]instanceof Array?(e=this.makeError(a,g,e,this[f](c+b[g][0]),d),e=this.makeError(a,g,e,this[f](c-b[g][1]),d)):(e=this.makeError(a,g,e,this[f](c+b[g]),d),e=this.makeError(a,g,e,this[f](c-b[g]),d));return e},setMaxErrorLevel:function(a){return this.maxLevel=a,this},makeError:function(a,b,c,d,e){if(b>=this.maxLevel)return c;var f=this.maxLevel-b;return 1==f?this["makeBar"+a.toUpperCase()](c,d,e):2==f?this["makeBox"+a.toUpperCase()](c,d,e):void 0},makeBarY:function(a,b,c){return a+" V "+b+" m -10 0 h 20 m -10 0 V "+c+" "},makeBoxY:function(a,b,c){return a+" h 5 V "+b+" h -10 V "+c+" h 5 "},makeBarX:function(a,b,c){return a+" H "+b+" m 0 -10 v 20 m 0 -10 H "+c+" "},makeBoxX:function(a,b,c){return a+" v 5 H "+b+" v -10 H "+c+" v 5 "},_addPoint:function(a,b,c){var d=document.createElementNS(this.graph.ns,"g");d.setAttribute("transform","translate("+a+", "+b+")"),this.extraStyle&&this.extraStyle[c]?this.doShape(d,this.extraStyle[c]):this.stdStylePerso?this.doShape(d,this.stdStylePerso):this.doShape(d,this.stdStyle),this.groupPoints.appendChild(d)},doShape:function(a,b){var c=document.createElementNS(this.graph.ns,b.shape);for(var d in b)"shape"!==d&&c.setAttribute(d,b[d]);a.appendChild(c)},setDataError:function(a){this.error=a}}),c}(c["graph._serie"]),c["series/graph.serie.zone"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{label:"",fillColor:"rgba( 0, 0, 0, 0.1 )",lineColor:"rgba( 0, 0, 0, 1 )",lineWidth:"1px"},init:function(a,d,e){this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupZones=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.lineZone=document.createElementNS(this.graph.ns,"path"),this.lineZone.setAttribute("stroke","black"),this.lineZone.setAttribute("stroke-width","1px"),this.additionalData={},this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupZones),this.groupZones.appendChild(this.lineZone),this.currentAction=!1,this.initExtended1&&this.initExtended1()},setData:function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(!(!a instanceof Array)){var g;a instanceof Array&&!(a[0]instanceof Array)?(b="1D",g=1.5*a.length,a[1]instanceof Array||(b="1D_flat",g=1*a.length)):a instanceof Array&&!(a[0][1]instanceof Array)?(b="2D_flat",g=3*a.length):(b="2D",g=3*a.length),d=this._addData(c,g),e=0;for(var h=0,i=a.length;i>h;h++)if("2D"==b||"2D_flat"==b)d[e]=a[h][0],this._checkX(d[e]),e++,"2D"==b?(d[e]=a[h][1][0],this._checkY(d[e]),e++,f++,d[e]=a[h][1][1],this._checkY(d[e]),e++,f++):(d[e]=a[h][1],this._checkY(d[e]),e++,f++,d[e]=a[h][2],this._checkY(d[e]),e++,f++);else if("1D_flat"==b){if(h%3==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h],this._checkY(d[e]),e++,f++}else{if(h%2==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h][0],this_checkY(d[e]),e++,f++,d[e]=a[h][1],this_checkY(d[e]),e++,f++}return this.graph.updateAxes(),this.data=d,this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},empty:function(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)},select:function(){this.selected=!0},unselect:function(){this.selected=!1},setDataStyle:function(a,b){return this.stdStylePerso=a,this.extraStyle=b,this},draw:function(){var a,b,c,d,e,f=0;this._drawn=!0,this.groupMain.removeChild(this.groupZones);this.data.length/2;f=0,d=0,e=this.data.length;for(var g=[],h=[];e>f;f+=3)a=this.getX(this.data[f]),b=this.getY(this.data[f+1]),c=this.getY(this.data[f+2]),c>b?(g.push([a,b]),h.push([a,c])):(g.push([a,c]),h.push([a,b]));h.reverse(),this.lineZone.setAttribute("d","M "+g[0]+" L "+g.join(" L ")+" L "+h.join(" L ")+" z"),this.applyLineStyle(this.lineZone),this.groupMain.appendChild(this.groupZones)},applyLineStyle:function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()),a.setAttribute("fill",this.getFillColor())},setLineWidth:function(a){return this.options.lineWidth=a,this},getLineWidth:function(){return this.options.lineWidth},setLineColor:function(a){return this.options.lineColor=a,this},getLineColor:function(){return this.options.lineColor},setFillColor:function(a){return this.options.fillColor=a,this},getFillColor:function(){return this.options.fillColor}}),c}(c["graph._serie"]),c["graph.serieaxis"]=function(a){var c=function(){};return a.prototype,b.extend(!0,c.prototype,a.prototype,{initExtended1:function(){this.initExtended2&&this.initExtended2()},setAxis:function(a){this.axis=a},kill:function(a){this.getAxis().groupSeries.removeChild(this.groupMain),this.getAxis().series.splice(this.getAxis().series.indexOf(this),1),a||this.graph.redraw()},getAxis:function(){return this.axis},getXAxis:function(){return this.axis},getYAxis:function(){return this.axis}}),c}(c["series/graph.serie.line"]),c["graph.serieaxisx"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{getY:function(a){var b=-Math.round(1e3*((a-this.minY)/(this.maxY-this.minY)))/1e3*(this.axis.totalDimension-this.axis._widthLabels)-this.axis._widthLabels;return b},getX:function(a){var b=Math.round(1e3*((a-this.axis.getActualMin())/this.axis._getActualInterval()*(this.axis.getMaxPx()-this.axis.getMinPx())+this.axis.getMinPx()))/1e3;return b},bindLabelHandlers:function(a){function b(b){if(d.axis.currentAction===!1){d.axis.currentAction="labelDragging",b.stopPropagation(),a.dragging=!0;var c=d.graph.getXY(b);a.draggingIniX=c.x,a.draggingIniY=c.y,d.labelDragging=a}}function c(b){d.axis.currentAction===!1&&(d.axis.currentAction="labelDraggingMain",b.preventDefault(),b.stopPropagation(),d.labelDragging=a)}var d=this;a.labelDom.addEventListener("mousedown",b),a.rect.addEventListener("mousedown",b),a.rect.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.labelDom.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.path.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.path.addEventListener("mousedown",c)}}),c}(c["graph.serieaxis"]),c["graph.serieaxisy"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{getX:function(a){var b=-Math.round(1e3*((a-this.minY)/(this.maxY-this.minY)))/1e3*(this.axis.totalDimension-this.axis._widthLabels)-this.axis._widthLabels-5;return b},getY:function(a){var b=Math.round(1e3*((a-this.axis.getActualMin())/this.axis._getActualInterval()*(this.axis.getMaxPx()-this.axis.getMinPx())+this.axis.getMinPx()))/1e3;return b},getMinX:function(){return this.minY},getMaxX:function(){return this.maxY},getMinY:function(){return this.minX},getMaxY:function(){return this.maxX}}),c}(c["graph.serieaxis"]),c["shapes/graph.shape"]=function(){function c(a){if(Array.isArray(a))switch(a.length){case 3:return"rgb("+a.join(",")+")";case 4:return"rgba("+a.join(",")+")"}else if("object"==typeof a)return"rgb("+Math.round(255*a.r)+", "+Math.round(255*a.g)+", "+Math.round(255*a.b)+")";return a}var d=function(){};return d.prototype={init:function(a,b){var c=this;this.graph=a,this.properties={},this.group=document.createElementNS(this.graph.ns,"g"),this.options=this.options||{},b&&this.group.setAttribute("data-groupname",b),this._selected=!1,this.createDom(),this.setEvents(),this.classes=[],this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent"),this._dom&&(this.group.appendChild(this._dom),this._dom.addEventListener("mouseover",function(a){c.handleMouseOver(a)}),this._dom.addEventListener("mouseout",function(a){c.handleMouseOut(a)}),this._dom.addEventListener("mousedown",function(a){c.graph.focus(),a.preventDefault(),c.handleSelected=!1,c.moving=!0,c.handleMouseDown(a)}),this._dom.addEventListener("dblclick",function(a){a.preventDefault(),a.stopPropagation(),c.handleDblClick(a)})),this.graph.shapeZone.appendChild(this.group),this.initImpl()},addClass:function(a){this.classes=this.classes||[],-1==this.classes.indexOf(a)&&this.classes.push(a),this.makeClasses()},removeClass:function(a){this.classes.splice(this.classes.indexOf(a),1),this.makeClasses()},makeClasses:function(){this._dom.setAttribute("class",this.classes.join(" "))},initImpl:function(){},setOriginalData:function(a,b){this.data=a,this.events=b},triggerChange:function(){this.graph.triggerEvent("onAnnotationChange",this.data,this)},setEvents:function(){},setSelectableOnClick:function(){return},setBBox:function(){this.group.removeChild(this.rectEvent);var a=this.group.getBBox();this.rectEvent.setAttribute("x",a.x),this.rectEvent.setAttribute("y",a.y-10),this.rectEvent.setAttribute("width",a.width),this.rectEvent.setAttribute("height",a.height+20),this.group.appendChild(this.rectEvent)},setMouseOver:function(a){this.rectEvent.addEventListener("mouseover",a)},kill:function(){this.graph.shapeZone.removeChild(this.group),this.graph.removeShape(this),this.options.onRemove&&this.options.onRemove.call(this)},draw:function(){void 0==this.labelNumber&&this.setLabelNumber(1),this.setFillColor(),this.setStrokeColor(),this.setStrokeWidth(),this.setDashArray(),this.everyLabel(function(a){this.get("labelPosition",a)&&(this.setLabelText(a),this.setLabelSize(a),this.setLabelColor(a),this.setLabelPosition(a)),this.get("labelAnchor",a)&&this._forceLabelAnchor(a)})},redraw:function(){this.position=this.setPosition(),this.redrawImpl(),this.position&&(this.everyLabel(function(a){this.get("labelPosition",a)&&(this.setLabelPosition(a),this.setLabelAngle(a))}),this.afterDone&&this.afterDone())},redrawImpl:function(){},done:function(){},setSerie:function(a){this.serie=a},set:function(a,b,c){this.properties[a]=this.properties[a]||[],this.properties[a][c||0]=b,this.configuration=this.configuration||{sections:{shape_cfg:[{groups:{shape_cfg:[{}]}}]}},this.configuration.sections.shape_cfg[0].groups.shape_cfg[0][a]=[b]},get:function(a){return this.configuration=this.configuration||{sections:{shape_cfg:[{groups:{shape_cfg:[{}]}}]}},((this.configuration.sections.shape_cfg[0].groups.shape_cfg[0]||[])[a]||[])[0]},getFromData:function(a){return this.data[a]},setData:function(a,b){return this.data[a]=b},setDom:function(a,b){this._dom&&this._dom.setAttribute(a,b)},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));return this.setDom("x",a.x),this.setDom("y",a.y),!0},setFillColor:function(){this.setDom("fill",c(this.get("fillColor")))},setStrokeColor:function(){this.setDom("stroke",c(this.get("strokeColor")))
},setStrokeWidth:function(){this.setDom("stroke-width",this.get("strokeWidth"))},setDashArray:function(){this.get("strokeDashArray")&&this.setDom("stroke-dasharray",this.get("strokeDashArray"))},setLabelText:function(a){this.label&&(this.label[a].textContent=this.data.label[a].text)},setLabelColor:function(a){this.label&&this.label[a].setAttribute("fill",this.get("labelColor"))},setLabelSize:function(a){this.label&&this.label[a].setAttribute("font-size",this.get("labelSize"))},setLabelPosition:function(a){this.label&&this._setLabelPosition(a)},setLabelAngle:function(a){this.label&&this._setLabelAngle(a)},_getPosition:function(a,b){var c,d=c=!1;return this.serie&&(d=this.serie.getXAxis(),c=this.serie.getYAxis()),this.graph.getPosition(a,b,d,c,this.serie)},setLabelNumber:function(a){this.labelNumber=a,this._makeLabel()},everyLabel:function(a){for(var b=0;b<this.labelNumber;b++)a.call(this,b)},toggleLabel:function(a,b){this.labelNumber&&this.label[i]&&this.label[i].setAttribute("display",b?"block":"none")},_makeLabel:function(){var a=this;this.label=this.label||[],this.everyLabel(function(c){this.label[c]=document.createElementNS(this.graph.ns,"text"),this.label[c].addEventListener("mouseover",function(a){a.stopPropagation()}),this.label[c].addEventListener("mouseout",function(a){a.stopPropagation()}),this.label[c].addEventListener("dblclick",function(d){d.preventDefault(),d.stopPropagation(),b('<input type="text" />').attr("value",d.target.textContent).prependTo(a.graph._dom).css({position:"absolute","margin-top":parseInt(d.target.getAttribute("y").replace("px",""))-10+"px","margin-left":parseInt(d.target.getAttribute("x").replace("px",""))-50+"px",textAlign:"center",width:"100px"}).bind("blur",function(){b(this).remove(),a.data.label[c].text=b(this).prop("value"),a.label[c].textContent=b(this).prop("value"),a.triggerChange()}).bind("keyup",function(a){a.stopPropagation(),a.preventDefault(),13==a.keyCode&&b(this).trigger("blur")}).bind("keypress",function(a){a.stopPropagation()}).bind("keydown",function(a){a.stopPropagation()}).focus().get(0).select()}),a.group.appendChild(this.label[c])})},_setLabelPosition:function(a,b){var c=this.getFromData("pos");if(c){{this._getPosition(c)}if(!b)var b=this._getPosition(this.get("labelPosition",a),c)}else b={x:-1e3,y:-1e3};"NaNpx"!=b.x&&(this.label[a].setAttribute("x",b.x),this.label[a].setAttribute("y",b.y))},_setLabelAngle:function(a){var b=this.get("labelAngle",a)||0;if(0!=b){var c=this.label[a].getAttribute("x"),d=this.label[a].getAttribute("y");this.label[a].setAttribute("transform","rotate("+b+" "+c+" "+d+")")}},_forceLabelAnchor:function(a){this.label[a].setAttribute("text-anchor",this._getLabelAnchor())},_getLabelAnchor:function(){var a=this.get("labelAnchor");switch(a){case"middle":case"start":case"end":return a;case"right":return"end";case"left":return"start";default:return"start"}},setSelectable:function(a){this._selectable=a},select:function(){this._selected=!0,this.selectStyle(),this.setHandles(),this.graph.selectShape(this)},unselect:function(){this._selected=!1,this.setStrokeWidth(),this.setStrokeColor(),this.setDashArray(),this.setFillColor(),this.handlesInDom&&(this.handlesInDom=!1,this.removeHandles())},createHandles:function(a,b,c){if(!this.isLocked())for(var d=this,e=1;a>=e;e++)!function(a){d["handle"+a]=document.createElementNS(d.graph.ns,b);for(var e in c)d["handle"+a].setAttribute(e,c[e]);d["handle"+a].addEventListener("mousedown",function(b){b.preventDefault(),b.stopPropagation(),d.handleSelected=a,d.handleMouseDown(b)})}(e)},handleMouseDownImpl:function(){},handleMouseMoveImpl:function(){},handleMouseUpImpl:function(){},handleCreateImpl:function(){},handlers:{mouseUp:[function(a){return this.moving=!1,this.resize=!1,this.graph.shapeMoving(!1),this.handleMouseUpImpl(a)}],mouseMove:[function(a){var b=this.graph.getXY(a),c=this.serie.getXAxis().getRelVal(b.x-this.mouseCoords.x),d=this.serie.getYAxis().getRelVal(b.y-this.mouseCoords.y);(0!=c||0!==d)&&(this.preventUnselect=!0),this.mouseCoords=b;var e=this.handleMouseMoveImpl(a,c,d,b.x-this.mouseCoords.x,b.y-this.mouseCoords.y);return this.options&&(this.moving?this.options.onMove&&this.options.onMove.call(this):this.options.onResize&&this.options.onResize.call(this)),e}],mouseDown:[function(b){var c=this;return b.preventDefault(),this.graph.shapeZone.appendChild(this.group),this.graph.shapeMoving(this),this._selected||(this.preventUnselect=!0,this.timeoutSelect=a.setTimeout(function(){c.select(),c.timeoutSelect=!1},100)),this.mouseCoords=this.graph.getXY(b),this.handleMouseDownImpl(b,this.mouseCoords)}],mouseOver:[function(){var a;this.highlight(),this.addClass("hover"),(a=this._mouseOverCallbacks)&&a.fireWith(this,[this.data,this.parameters])}],mouseOut:[function(){var a;this.unhighlight(),this.removeClass("hover"),(a=this._mouseOutCallbacks)&&a.fireWith(this,[this.data,this.parameters])}]},handleMouseDown:function(a){this.callHandler("mouseDown",a)},handleMouseMove:function(a){return this.isLocked()?(this.graph.shapeMoving(!1),this.handleSelected=!1,void(this.moving=!0)):void this.callHandler("mouseMove",a)},handleMouseUp:function(a){this.callHandler("mouseUp",a)},handleMouseOver:function(){this.callHandler("mouseOver")},handleMouseOut:function(){this.callHandler("mouseOut")},removeHandles:function(){for(var a=1;a<=this.nbHandles;a++)this.group.removeChild(this["handle"+a])},callHandler:function(a){{var b,c=a;Array.prototype.shift.call(arguments)}if(b=d.prototype.handlers[c])for(var e=0,f=b.length;f>e;e++)b[e].apply(this,arguments);if(b=this.graph.shapeHandlers[c])for(var e=0,f=b.length;f>e;e++)b[e].apply(this,arguments)},addHandles:function(){if(!this.isLocked()&&!this.handlesInDom){this.handlesInDom=!0;for(var a=1;a<=this.nbHandles;a++)this["handle"+a]&&this.group.appendChild(this["handle"+a])}},handleDblClick:function(){this.configure()},configure:function(){var a=this,c=b("<div></div>").dialog({modal:!0,position:["center",50],width:"80%"});c.prev().remove(),c.parent().css("z-index",1e3),require(["require","lib/lib/forms/form"],function(b,d){var e=new d({});e.init();var f={sections:{shape_cfg:{options:{title:"Shape",icon:"info_rhombus"},groups:{shape_cfg:{options:{type:"list"},fields:a.getFieldsConfig()}}}}};e.setStructure(f),e.onStructureLoaded().done(function(){e.fill(a.getConfiguration())}),e.addButton("Cancel",{color:"blue"},function(){c.dialog("close")}),e.addButton("Save",{color:"green"},function(){a.setConfiguration(e.getValue()),c.dialog("close")}),e.onLoaded().done(function(){c.html(e.makeDom()),e.inDom()})})},getConfiguration:function(){return this.configuration=this.configuration||{}},setConfiguration:function(a){this.configuration=b.extend(!0,this.configuration,a)},isLocked:function(){return this.options.locked||this.graph.shapesLocked},lock:function(){this.options.locked=!0},unlock:function(){this.options.locked=!1},isBindable:function(){return this.options.bindable},setBindableToDom:function(){this.isBindable()&&this.addClass("bindable")},highlight:function(){},unhighlight:function(){}},d}(),c["shapes/graph.shape.areaundercurve"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"path"),this._dom.setAttribute("pointer-events","stroke")},handleCreateImpl:function(){this.resize=!0,this.resizingElement=2},handleMouseDownImpl:function(){},handleMouseUpImpl:function(){},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){var d=this.getFromData("pos"),e=this.getFromData("pos2");if(this.moving)d.x=this.graph.deltaPosition(d.x,b,this.serie.getXAxis()),d.y=this.graph.deltaPosition(d.y,c,this.serie.getYAxis()),e.x=this.graph.deltaPosition(e.x,b,this.serie.getXAxis()),e.y=this.graph.deltaPosition(e.y,c,this.serie.getYAxis());else{this.resizingPosition=this.getFromData(this.reversed&&2==this.handleSelected||!this.reversed&&1==this.handleSelected?"pos":"pos2");var f=this.serie.searchClosestValue(this.serie.getXAxis().getVal(this.graph.getXY(a).x-this.graph.getPaddingLeft()));if(!f)return;this.resizingPosition.x!=f.xMin&&(this.preventUnselect=!0),this.resizingPosition.x=f.xMin}this.position=this.setPosition(),this.setHandles()}},redrawImpl:function(){this.position!=this.doDraw&&(this.group.setAttribute("visibility",this.position?"visible":"hidden"),this.doDraw=this.position)},setPosition:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth())return!1;var e,f,g,h,i,j,d,k,l,m=this.serie.searchClosestValue(this.getFromData("pos").x),n=this.serie.searchClosestValue(this.getFromData("pos2").x),o=0,p=Number.MAX_VALUE;if(!m||!n)return!1;for(m.xBeforeIndex>n.xBeforeIndex&&(e=m,m=n,n=e),f=m.dataIndex;f<=n.dataIndex;f++){for(l="M ",h=f==m.dataIndex?m.xBeforeIndexArr:0,i=f==n.dataIndex?n.xBeforeIndexArr:this.serie.data[f].length,j=0,g=h;i>=g;g+=2)d=this.serie.getX(this.serie.data[f][g+0]),k=this.serie.getY(this.serie.data[f][g+1]),o=Math.max(this.serie.data[f][g+1],o),p=Math.min(this.serie.data[f][g+1],p),g==h&&(this.firstX=d,this.firstY=k),l=this.serie._addPoint(l,d,k,j),j++;if(this.lastX=d,this.lastY=k,!(this.firstX&&this.firstY&&this.lastX&&this.lastY))return;l+=" V "+this.serie.getYAxis().getPx(0)+" H "+this.firstX+" z",this.setDom("d",l)}return this.maxY=this.serie.getY(o),this._selected&&this.select(),!0},select:function(){this.isLocked()||this.firstX&&this.lastX&&(this._selected=!0,this.selectHandles(),this.group.appendChild(this.handle1),this.group.appendChild(this.handle2),this.selectStyle(),this.graph.selectShape(this))},selectHandles:function(){this.handle1.setAttribute("x1",this.firstX),this.handle1.setAttribute("x2",this.firstX),this.handle2.setAttribute("x1",this.lastX),this.handle2.setAttribute("x2",this.lastX),this.handle1.setAttribute("y1",this.serie.getYAxis().getMaxPx()),this.handle1.setAttribute("y2",this.serie.getY(0)),this.handle2.setAttribute("y1",this.serie.getYAxis().getMaxPx()),this.handle2.setAttribute("y2",this.serie.getY(0))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2"),this.setDom("fill","rgba(255, 0, 0, 0.1)")},setLabelPosition:function(a){var b=(this.firstX+this.lastX)/2+"px",c=(this.lastPointY+this.firstPointY)/2+"px",d=this.serie.isFlipped();this._setLabelPosition(a,{x:d?c:b,y:d?b:c})},getFieldsConfig:function(){return{strokeWidth:{type:"float","default":1,title:"Stroke width"},strokeColor:{type:"color",title:"Stroke color"},fillColor:{type:"color",title:"Fill color"}}}}),c}(c["shapes/graph.shape"]),c["shapes/graph.shape.line"]=function(a){var c=function(a,b){this.init(a),this.options=b||{},this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line")},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a.x&&a.y)return this.setDom("x2",a.x),this.setDom("y2",a.y),this.currentPos1x=a.x,this.currentPos1y=a.y,!0},setPosition2:function(){var a=this._getPosition(this.getFromData("pos2"),this.getFromData("pos"));a.x&&a.y&&(this.setDom("y1",a.y),this.setDom("x1",a.x),this.currentPos2x=a.x,this.currentPos2y=a.y)},redrawImpl:function(){this.setPosition(),this.setPosition2(),this.setHandles()},getLinkingCoords:function(){return{x:(this.currentPos2x+this.currentPos1x)/2,y:(this.currentPos2y+this.currentPos1y)/2}},handleCreateImpl:function(){this.resize=!0,this.handleSelected=2},handleMouseDownImpl:function(){return!0},handleMouseUpImpl:function(){return this.triggerChange(),!0},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){var d=this.getFromData("pos"),e=this.getFromData("pos2");if(1==this.handleSelected&&(this.options.vertical||(d.x=this.graph.deltaPosition(d.x,b,this.serie.getXAxis())),this.options.horizontal||(d.y=this.graph.deltaPosition(d.y,c,this.serie.getYAxis()))),2==this.handleSelected&&(this.options.vertical||(e.x=this.graph.deltaPosition(e.x,b,this.serie.getXAxis())),this.options.horizontal||(e.y=this.graph.deltaPosition(e.y,c,this.serie.getYAxis()))),this.options.forcedCoords){var f=this.options.forcedCoords;void 0!==f.y&&(e.y=f.y,d.y=f.y),void 0!==f.x&&(e.x=f.x,d.x=f.x)}return this.moving&&(d.x=this.graph.deltaPosition(d.x,b,this.serie.getXAxis()),d.y=this.graph.deltaPosition(d.y,c,this.serie.getYAxis()),e.x=this.graph.deltaPosition(e.x,b,this.serie.getXAxis()),e.y=this.graph.deltaPosition(e.y,c,this.serie.getYAxis())),this.redrawImpl(),!0}},setHandles:function(){this.isLocked()||this._selected&&void 0!=this.currentPos1x&&(this.addHandles(),this.handle1.setAttribute("x",this.currentPos1x),this.handle1.setAttribute("y",this.currentPos1y),this.handle2.setAttribute("x",this.currentPos2x),this.handle2.setAttribute("y",this.currentPos2y))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")}}),c}(c["shapes/graph.shape"]),c["shapes/graph.shape.arrow"]=function(a){var c=function(a){this.init(a)};b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#arrow"+this.graph._creation+")")}});var d=function(a){this.init(a)};return b.extend(d.prototype,a.prototype,{initImpl:function(){this._dom.style.cursor="ew-resize"},setEvents:function(){var a=this;this._dom.addEventListener("mousedown",function(b){b.preventDefault(),b.stopPropagation(),a.handleMouseDown(b)}),this._dom.addEventListener("mousemove",function(b){b.preventDefault(),b.stopPropagation(),a.handleMouseMove(b)}),this._dom.addEventListener("mouseup",function(b){b.preventDefault(),b.stopPropagation(),a.handleMouseUp(b)})},handleMouseDown:function(a){this.moving=!0,this.graph.shapeMoving(this),this.coordsI=this.graph.getXY(a)},handleMouseMove:function(a){if(this.moving){var b=this.graph.getXY(a),c=this.graph.getXAxis().getRelPx(b.x-this.coordsI.x),d=this.getFromData("pos");d.x+=c,this.coordsI=b,this.setPosition()}},handleMouseUp:function(){this.moving=!1,this.triggerChange()},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));this.setDom("x1",a.x),this.setDom("x2",a.x),this.setDom("y1",this.graph.getYAxis().getMinPx()),this.setDom("y2",this.graph.getYAxis().getMaxPx())},setPosition2:function(){}}),c}(c["shapes/graph.shape.line"]),c["shapes/graph.shape.label"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=!1},setPosition:function(){var a=this._getPosition(this.get("labelPosition"));a&&this.everyLabel(function(b){this.label[b].setAttribute("x",a.x),this.label[b].setAttribute("y",a.y)})},redrawImpl:function(){this.draw()}}),c}(c["shapes/graph.shape"]),c["shapes/graph.shape.nmrintegral"]=function(a){var c=function(a,b){this.init(a,"nmrintegral"),this.options=b||{},this.options.axis=this.options.axis||"x",this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(c.prototype,a.prototype,{setPosition:function(){var a,b,c=this.yBaseline||30,d=this._getPosition(this.getFromData("pos")),e=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),f=this.options.axis;if(d&&e){if(this.serie.isFlipped()?(c=this.serie.getXAxis().getPx(0)-c,a=Math.abs(d.y-e.y),b=Math.min(d.y,e.y)):(c=this.serie.getYAxis().getPx(0)-c,a=Math.abs(d.x-e.x),b=Math.min(d.x,e.x)),this.computedBaseline=c,this.reversed=b==e.x,"x"==f){if(2>a||0>b+a||b>this.graph.getDrawingWidth())return!1}else if(2>a||0>b+a||b>this.graph.getDrawingHeight())return!1;{var g,h,i,j,k,l,b,m,n,o,p=this.serie.searchClosestValue(this.getFromData("pos")[f]),q=this.serie.searchClosestValue(this.getFromData("pos2")[f]),r="",s=0,t=1,u=0;Number.MAX_VALUE}if(!p||!q)return!1;p.xBeforeIndex>q.xBeforeIndex&&(g=p,p=q,q=g);var n,o,v,w,x,y,z,A,B,C=0,D=(this.scaling,[]);for(this.serie.isFlipped()&&(t=0,u=1),h=p.dataIndex;h<=q.dataIndex;h++){for(j=h==p.dataIndex?p.xBeforeIndexArr:0,k=h==q.dataIndex?q.xBeforeIndexArr:this.serie.data[h].length,l=0,i=j;k>=i;i+=2){if(b=this.serie.getX(this.serie.data[h][i+u]),m=this.serie.getY(this.serie.data[h][i+t]),this.serie.isFlipped()){var E=b;b=m,m=E}n||(n=b,o=m,x=this.serie.data[h][i+u],y=this.serie.data[h][i+t]),void 0!=v?(C+=Math.abs((this.serie.data[h][i+u]-z)*(this.serie.data[h][i+t]-y)*.5),(b!=v||m!=w)&&(v=b,w=m,D.push([b,C]),l++)):(v=b,w=m,z=this.serie.data[h][i+u],A=this.serie.data[h][i+t])}if(this.lastX=b,this.lastY=m,!(n&&o&&this.lastX&&this.lastY))return}0==C&&(C=1),this.maxPx=this.options.maxPx||50,this.ratio||(this.ratio=1);for(var F=this.maxIntegration||C,h=0,G=D.length;G>h;h++)D[h][1]=c-D[h][1]/C*this.maxPx*(C/F)*this.ratio,0==h&&(this.firstPointY=D[h][1]),r+=" L "+D[h][u]+", "+D[h][t]+" ",this.lastPointY=D[h][1];this.points=D,this.lastSum=C;var w=o,v=this.lastX;return B=Math.min(20,v-n),r=this.serie.isFlipped()?" M "+c+", "+n+" "+r:" M "+n+", "+c+" "+r,this.setDom("d",r),this.firstX=n,this.firstY=o,this.maxY=this.serie.getY(s),this._selected&&this.select(),this.setHandles(),!0}},setScale:function(a,b){this.maxPx=a,this.maxIntegration=b},setYBaseline:function(a){this.yBasline=a},selectStyle:function(){this.setDom("stroke-width","2px")},selectHandles:function(){},setHandles:function(){this._selected&&void 0!=this.points&&(this.addHandles(),this.handle1.setAttribute("x",this.points[0][0]),this.handle1.setAttribute("y",this.points[0][1]),this.handle2.setAttribute("x",this.points[this.points.length-1][0]-1),this.handle2.setAttribute("y",this.points[this.points.length-1][1]))}}),c}(c["shapes/graph.shape.areaundercurve"]),c["shapes/graph.shape.rect"]=function(a){var c=function(a,b){this.options=b,this.init(a),this.graph=a,this.nbHandles=4,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white"}),this.handle2.setAttribute("cursor","nesw-resize"),this.handle4.setAttribute("cursor","nesw-resize"),this.handle1.setAttribute("cursor","nwse-resize"),this.handle3.setAttribute("cursor","nwse-resize")};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect")},setWidthPx:function(a){this.set("width",a)},setHeightPx:function(a){this.set("height",a)},setFullWidth:function(){this.set("x",Math.min(this.serie.getXAxis().getMinPx(),this.serie.getXAxis().getMaxPx())),this.set("width",Math.abs(this.serie.getXAxis().getMaxPx()-this.serie.getXAxis().getMinPx()))},setFullHeight:function(){this.set("y",Math.min(this.serie.getYAxis().getMinPx(),this.serie.getYAxis().getMaxPx())),this.set("height",Math.abs(this.serie.getYAxis().getMaxPx()-this.serie.getYAxis().getMinPx()))},setPosition:function(){var a=this.getFromData("width"),b=this.getFromData("height"),c=this._getPosition(this.getFromData("pos")),d=c.x,e=c.y;if(void 0==a||void 0==b){var f=this._getPosition(this.getFromData("pos2"));a=f.x-c.x,b=f.y-c.y}else a=this.graph.getPxRel(a,this.serie.getXAxis()),b=this.graph.getPxRel(b,this.serie.getYAxis());return d=c.x,e=c.y,0>a&&(d+=a,a*=-1),0>b&&(e+=b,b*=-1),0/0!==d&&d!==!1&&0/0!==e&&e!==!1?(this.setDom("width",a),this.setDom("height",b),this.setDom("x",d),this.setDom("y",e),this.currentX=d,this.currentY=e,this.currentW=a,this.currentH=b,this.setHandles(),!0):!1},getLinkingCoords:function(){return{x:this.currentX+this.currentW/2,y:this.currentY+this.currentH/2}},redrawImpl:function(){},handleCreateImpl:function(){this.resize=!0,this.handleSelected=3},handleMouseDownImpl:function(){},handleMouseUpImpl:function(){},handleMouseMoveImpl:function(a,b,c){if(this.moving||this.handleSelected){var d=this.getFromData("width")||0,e=this.getFromData("height")||0,f=this.getFromData("pos"),g=this.getFromData("pos2");if(g){var h=this.serie.getXAxis().isFlipped(),i=this.serie.getYAxis().isFlipped(),j=f.x,k=f.y,l=g.x,m=g.y;if(this.moving)return f.x=this.graph.deltaPosition(f.x,b,this.serie.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.serie.getYAxis()),g.x=this.graph.deltaPosition(g.x,b,this.serie.getXAxis()),g.y=this.graph.deltaPosition(g.y,c,this.serie.getYAxis()),this.setData("pos",f),this.setData("pos2",g),void this.setPosition();if(1==this.handleSelected||4==this.handleSelected)var n=!h;else var n=h;if(l>j&&n||j>=l&&!n?j=this.graph.deltaPosition(j,b,this.serie.getXAxis()):l=this.graph.deltaPosition(l,b,this.serie.getXAxis()),1==this.handleSelected||2==this.handleSelected)var n=!i;else var n=i;m>k&&n||k>=m&&!n?k=this.graph.deltaPosition(k,c,this.serie.getYAxis()):m=this.graph.deltaPosition(m,c,this.serie.getYAxis()),(m>k&&g.y<f.y||k>m&&g.y>f.y)&&(1==this.handleSelected?this.handleSelected=4:2==this.handleSelected?this.handleSelected=3:3==this.handleSelected?this.handleSelected=2:4==this.handleSelected&&(this.handleSelected=1)),(l>j&&g.x<f.x||j>l&&g.x>f.x)&&(1==this.handleSelected?this.handleSelected=2:2==this.handleSelected?this.handleSelected=1:3==this.handleSelected?this.handleSelected=4:4==this.handleSelected&&(this.handleSelected=3)),g.x=l,g.y=m,f.x=j,f.y=k,this.setData("pos2",g)}else{if(this.moving)return f.x=this.graph.deltaPosition(f.x,b,this.serie.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.serie.getYAxis()),this.setData("pos",f),void this.setPosition();1==this.handleSelected&&(f.x=this.graph.deltaPosition(f.x,b,this.serie.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.serie.getYAxis()),d=this.graph.deltaPosition(d,-b,this.serie.getXAxis()),e=this.graph.deltaPosition(e,-c,this.serie.getYAxis())),2==this.handleSelected&&(f.y=this.graph.deltaPosition(f.y,c,this.serie.getYAxis()),d=this.graph.deltaPosition(d,b,this.serie.getXAxis()),e=this.graph.deltaPosition(e,-c,this.serie.getYAxis())),3==this.handleSelected&&(d=this.graph.deltaPosition(d,b,this.serie.getXAxis()),e=this.graph.deltaPosition(e,c,this.serie.getYAxis())),4==this.handleSelected&&(f.x=this.graph.deltaPosition(f.x,b,this.serie.getXAxis()),d=this.graph.deltaPosition(d,-b,this.serie.getXAxis()),e=this.graph.deltaPosition(e,c,this.serie.getYAxis()));var o=this.graph.getPxRel(d,this.serie.getXAxis()),p=this.graph.getPxRel(e,this.serie.getYAxis());0>o&&(f.x=this.graph.deltaPosition(f.x,d),d=-d,1==this.handleSelected?this.handleSelected=2:2==this.handleSelected?this.handleSelected=1:3==this.handleSelected?this.handleSelected=4:4==this.handleSelected&&(this.handleSelected=3)),0>p&&(f.y=this.graph.deltaPosition(f.y,e),e=-e,1==this.handleSelected?this.handleSelected=4:2==this.handleSelected?this.handleSelected=3:3==this.handleSelected?this.handleSelected=2:4==this.handleSelected&&(this.handleSelected=1)),this.setData("width",d),this.setData("height",e)}this.setData("pos",f),this.setPosition()}},setHandles:function(){this._selected&&void 0!=this.currentX&&(this.addHandles(),this.handle1.setAttribute("x",this.currentX),this.handle1.setAttribute("y",this.currentY),this.handle2.setAttribute("x",this.currentX+this.currentW),this.handle2.setAttribute("y",this.currentY),this.handle3.setAttribute("x",this.currentX+this.currentW),this.handle3.setAttribute("y",this.currentY+this.currentH),this.handle4.setAttribute("x",this.currentX),this.handle4.setAttribute("y",this.currentY+this.currentH))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2"),this.setDom("fill","rgba(255, 0, 0, 0.1)")}}),c}(c["shapes/graph.shape"]),c["shapes/graph.shape.peakintegration2d"]=function(a){var c=5,d=function(a,b){this.options=b||{},this.init(a),this.nbHandles=4,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(d.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.element=this},redrawImpl:function(){this.setPosition(),this.setHandles(),this.setBindableToDom(this._dom)},highlight:function(){this._dom.setAttribute("stroke-width","5"),this.setLinesY(c+2)},unhighlight:function(){this.setStrokeWidth(),this.setLinesY(c)}}),d}(c["shapes/graph.shape.rect"]),c["shapes/graph.shape.peakinterval"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#verticalline"+this.graph._creation+")"),this._dom.setAttribute("marker-start","url(#verticalline"+this.graph._creation+")")},setLabelPosition:function(a){var b=this._getPosition(this.getFromData("pos")),c=this._getPosition(this.getFromData("pos2"),this.getFromData("pos"));this._setLabelPosition(a,this._getPosition(this.get("labelPosition",a),{x:(b.x+c.x)/2+"px",y:(b.y+c.y)/2+"px"}))},afterDone:function(){}}),c}(c["shapes/graph.shape.line"]),c["shapes/graph.shape.peakinterval2"]=function(a){var c=5,d=function(a,b){this.options=b||{},this.init(a),this.nbHandles=2,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})};return b.extend(d.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this.line1=document.createElementNS(this.graph.ns,"line"),this.line2=document.createElementNS(this.graph.ns,"line"),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.line1.setAttribute("stroke","black"),this.line2.setAttribute("stroke","black"),this._dom.element=this},redrawImpl:function(){this.setPosition(),this.setPosition2(),this.setHandles(),this.redrawLines(c),this.setBindableToDom(this._dom)},redrawLines:function(a){var b=this.findxs(),c=this._getPosition({x:b[0]}),d=this._getPosition({x:b[1]});c.x&&d.x&&this.currentPos2y&&this.currentPos1y&&(this.line1.setAttribute("x1",c.x),this.line1.setAttribute("x2",c.x),this.line2.setAttribute("x1",d.x),this.line2.setAttribute("x2",d.x),this.setLinesY(a))},setLinesY:function(a){this.line1.setAttribute("y1",this.currentPos2y-a),this.line1.setAttribute("y2",this.currentPos2y+a),this.line2.setAttribute("y1",this.currentPos1y-a),this.line2.setAttribute("y2",this.currentPos1y+a)},findxs:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth())return!1;{var e,f,g,h,i,j,d,k,l,m,n=this.serie.searchClosestValue(this.getFromData("pos").x),o=this.serie.searchClosestValue(this.getFromData("pos2").x);Number.MAX_VALUE}if(!n||!o)return!1;n.xBeforeIndex>o.xBeforeIndex&&(e=n,n=o,o=e);var l,m,p,q,r=0,s=(this.scaling,[]),t=[];for(f=n.dataIndex;f<=o.dataIndex;f++){for(h=f==n.dataIndex?n.xBeforeIndexArr:0,i=f==o.dataIndex?o.xBeforeIndexArr:this.serie.data[f].length,j=0,g=h;i>=g;g+=2)d=this.serie.data[f][g+0],k=this.serie.data[f][g+1],l||(l=d,m=k),void 0==p&&(p=d,q=k),r+=Math.abs((d-p)*(k-q)*.5),s.push(r),t.push(d),p=d,q=k,j++;if(this.lastX=d,this.lastY=k,!(l&&m&&this.lastX&&this.lastY))return!1}if(0==r)return[l,p];for(var u=.05*r,v=.95*r,w=!1,x=!1,f=0,y=s.length;y>f;f++)if(s[f]>u){w=f;break}for(var f=s.length;f>0;f--)if(s[f]<v){x=f;break}return[t[w],t[x]]},highlight:function(){this.isBindable()&&(this._dom.setAttribute("stroke-width","5"),this.setLinesY(c+2))},unhighlight:function(){this.isBindable()&&(this.setStrokeWidth(),this.setLinesY(c))}}),d}(c["shapes/graph.shape.line"]),c["shapes/graph.shape.rangex"]=function(a){var c=function(a){this.init(a)};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.setAttribute("class","rangeRect"),this._dom.setAttribute("cursor","move"),this.handle1=this._makeHandle(),this.handle2=this._makeHandle(),this.setDom("cursor","move"),this.doDraw=void 0},setPosition:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);return this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth()?!1:(this.group.appendChild(this.handle1),this.group.appendChild(this.handle2),this.handle1.setAttribute("transform","translate("+(d-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift[0])/2-10)+")"),this.handle2.setAttribute("transform","translate("+(d+c-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift[0])/2-10)+")"),this.setDom("x",d),this.setDom("width",c),this.setDom("y",0),this.setDom("height",this.graph.getDrawingHeight()-this.graph.shift[0]),!0)},_makeHandle:function(){var a=document.createElementNS(this.graph.ns,"g");a.setAttribute("id","rangeHandle"+this.graph._creation);var b=document.createElementNS(this.graph.ns,"rect");b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("stroke","black"),b.setAttribute("fill","white"),b.setAttribute("width",10),b.setAttribute("height",20),b.setAttribute("x",0),b.setAttribute("y",0),b.setAttribute("shape-rendering","crispEdges"),b.setAttribute("cursor","ew-resize"),a.appendChild(b);var c=document.createElementNS(this.graph.ns,"line");c.setAttribute("x1",4),c.setAttribute("x2",4),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c);var c=document.createElementNS(this.graph.ns,"line");return c.setAttribute("x1",6),c.setAttribute("x2",6),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c),a}}),c}(c["shapes/graph.shape.areaundercurve"]),c["graph.toolbar"]=function(){function a(){var a=document.createElementNS(g,"svg");return a.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("xmlns",g),a}function c(){var b=a(),c=document.createElementNS(g,"line");return c.setAttribute("x1",16),c.setAttribute("y1",3),c.setAttribute("x2",4),c.setAttribute("y2",15),c.setAttribute("stroke","#aa0000"),b.appendChild(c),b}function d(){var b=a(),c=document.createElementNS(g,"rect");return c.setAttribute("x",4),c.setAttribute("y",4),c.setAttribute("width",12),c.setAttribute("height",12),c.setAttribute("stroke","black"),c.setAttribute("fill","#dd0000"),b.appendChild(c),b}function e(){var b="M 4,18 C 8,10 14,1 18,18",c=a(),d=document.createElementNS(g,"path");d.setAttribute("d",b),d.setAttribute("stroke","black"),d.setAttribute("fill","transparent");var e=document.createElementNS(g,"path");return e.setAttribute("d",b+" Z"),e.setAttribute("stroke","red"),e.setAttribute("fill","rgba(255, 0, 0, 0.1)"),c.appendChild(e),c.appendChild(d),c}var f={buttons:["none","rect","line","areaundercurve"]},g="http://www.w3.org/2000/svg",h=function(a,c){var d=this;this.options=b.extend(!0,{},f,c),this.graph=a,this.div=b("<ul />").addClass("graph-toolbar"),this.graph.getPlugin("./graph.plugin.shape").then(function(a){d.plugin=a,d.plugin&&(d.div.on("click","li",function(){var a=b(this).attr("data-shape");d.plugin.setShape(a),b(this).parent().children().removeClass("selected"),b(this).addClass("selected")}),d.makeButtons())})};return h.prototype={makeButtons:function(){for(var a=0,b=this.options.buttons.length;b>a;a++)this.div.append(this.makeButton(this.options.buttons[a]))},makeButton:function(a){var f=b("<li />");switch(a){case"line":f.html(c()).attr("data-shape","line");break;case"rect":f.html(d()).attr("data-shape","rect");break;case"areaundercurve":f.html(e()).attr("data-shape","areaundercurve")}return f},getDom:function(){return this.div}},h}(),c["graph.xaxis.time"]=function(a){var c=function(a,b,c){this.init(a,c),this.top="top"==b};return b.extend(c.prototype,a.prototype,{getAxisPosition:function(){var a=(1==this.options.tickPosition?15:25)+2*this.graph.options.fontSize;return this.options.allowedPxSerie&&this.series.length>0&&(a+=this.options.allowedPxSerie),a
},getAxisWidthHeight:function(){},_setShift:function(){this.group.setAttribute("transform","translate(0 "+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},getMaxSizeTick:function(){return(this.top?-1:1)*(1==this.options.tickPosition?15:25)},drawTick:function(a,b,c,d){var e=(this.groupTicks,document.createElementNS(this.graph.ns,"line")),f=this.getPos(a);if(void 0!=f){if(e.setAttribute("shape-rendering","crispEdges"),e.setAttribute("x1",f),e.setAttribute("x2",f),e.setAttribute("y1",(this.top?1:-1)*this.tickPx1*c),e.setAttribute("y2",(this.top?1:-1)*this.tickPx2*c),b&&this.options.primaryGrid?this.doGridLine(!0,f,f,0,this.graph.getDrawingHeight()):!b&&this.options.secondaryGrid&&this.doGridLine(!1,f,f,0,this.graph.getDrawingHeight()),e.setAttribute("stroke","black"),this.groupTicks.appendChild(e),b){var g=(this.groupTickLabels,document.createElementNS(this.graph.ns,"text"));g.setAttribute("x",f),g.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?8:25)+(this.top?10:0))),g.setAttribute("text-anchor","middle"),g.style.dominantBaseline="hanging",this.setTickContent(g,a,d),this.graph.applyStyleText(g),this.groupTickLabels.appendChild(g)}this.ticks.push(e)}},drawSpecifics:function(){this.label.setAttribute("text-anchor","middle"),this.label.setAttribute("x",Math.abs(this.getMaxPx()-this.getMinPx())/2+this.getMinPx()),this.label.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?10:15)+this.graph.options.fontSize)),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0),this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging"},drawSeries:function(){if(this.shift){this.rectEvent.setAttribute("y",this.top?-this.shift:0),this.rectEvent.setAttribute("height",this.totalDimension),this.rectEvent.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.rectEvent.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx())),this.clipRect.setAttribute("y",this.top?-this.shift:0),this.clipRect.setAttribute("height",this.totalDimension),this.clipRect.setAttribute("x",Math.min(this.getMinPx(),this.getMaxPx())),this.clipRect.setAttribute("width",Math.abs(this.getMinPx()-this.getMaxPx()));for(var a=0,b=this.series.length;b>a;a++)this.series[a].draw()}},_draw0Line:function(a){this._0line=document.createElementNS(this.graph.ns,"line"),this._0line.setAttribute("x1",a),this._0line.setAttribute("x2",a),this._0line.setAttribute("y1",0),this._0line.setAttribute("y2",this.getMaxPx()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},addSerie:function(a,b){var c=new GraphSerieAxisX(a,b);return c.setAxis(this),c.init(this.graph,a,b),c.autoAxis(),c.setXAxis(this),this.series.push(c),this.groupSeries.appendChild(c.groupMain),this.groupSeries.setAttribute("clip-path","url(#_clip"+this.axisRand+")"),c},handleMouseMoveLocal:function(a){a-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(a)},isXY:function(){return"x"}}),c}(c["graph.axis"]),c["graph.core"]};if("function"==typeof define&&define.amd)define(["jquery"],function(a){return b(a)});else if(a){if(!a.jQuery)throw"jQuery has not been loaded. Abort graph initialization.";a.Graph=b(a.jQuery)}});